{"version":3,"file":"AdminAppealsPage-BqyByHLx.js","sources":["../../src/hooks/useAppeals.js","../../src/pages/admin/AdminAppealsPage.jsx"],"sourcesContent":["import { useEffect, useState, useCallback } from \"react\";\r\nimport { getAppeals, updateAppeal } from \"@/lib/adminApi\";\r\nimport { toast } from \"@/hooks/use-toast\";\r\n\r\nexport default function useAppeals() {\r\n  const [appeals, setAppeals] = useState([]);\r\n  const [meta, setMeta] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [filters, setFilters] = useState({\r\n    search: \"\",\r\n    status: \"\",\r\n    page: 1,\r\n  });\r\n\r\n  const fetchAppeals = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await getAppeals({\r\n        search: filters.search || undefined,\r\n        status: filters.status || undefined,\r\n        page: filters.page,\r\n      });\r\n\r\n      console.log(\"APPEALS API RESPONSE:\", response.data);\r\n\r\n      setAppeals(response.data.appeals.data);\r\n      setMeta(response.data.appeals);\r\n    } catch (error) {\r\n      console.error(error);\r\n      toast({\r\n        title: \"Failed to load appeals\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters]);\r\n\r\n  useEffect(() => {\r\n    fetchAppeals();\r\n  }, [fetchAppeals]);\r\n\r\n  const refresh = () => fetchAppeals();\r\n\r\n  const updateStatus = async (id, data) => {\r\n    try {\r\n      await updateAppeal(id, data);\r\n      toast({ title: \"Appeal updated\" });\r\n      fetchAppeals();\r\n    } catch {\r\n      toast({\r\n        title: \"Failed to update appeal\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return {\r\n    appeals,\r\n    meta,\r\n    loading,\r\n    filters,\r\n    setFilters,\r\n    refresh,\r\n    updateStatus,\r\n  };\r\n}\r\n","import {\r\n  Card,\r\n  CardHeader,\r\n  CardTitle,\r\n  CardContent,\r\n} from \"@/components/ui/card\";\r\nimport {\r\n  Table,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n  TableCell,\r\n  TableBody,\r\n} from \"@/components/ui/table\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport {\r\n  Select,\r\n  SelectTrigger,\r\n  SelectValue,\r\n  SelectContent,\r\n  SelectItem,\r\n} from \"@/components/ui/select\";\r\nimport { RefreshCcw } from \"lucide-react\";\r\n\r\nimport useAppeals from \"@/hooks/useAppeals\";\r\n\r\nexport default function AdminAppealsPage() {\r\n  const {\r\n    appeals,\r\n    meta,\r\n    loading,\r\n    filters,\r\n    setFilters,\r\n    refresh, // ✅ USE THIS\r\n    updateStatus,\r\n  } = useAppeals();\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <h1 className=\"text-xl font-semibold\">Appeals</h1>\r\n\r\n      {/* Filters */}\r\n      <div className=\"flex gap-2 flex-wrap\">\r\n        <Input\r\n          className=\"w-56\"\r\n          placeholder=\"Search...\"\r\n          value={filters.search}\r\n          onChange={(e) =>\r\n            setFilters({\r\n              ...filters,\r\n              search: e.target.value,\r\n              page: 1,\r\n            })\r\n          }\r\n        />\r\n\r\n        <Select\r\n          value={filters.status || \"all\"}\r\n          onValueChange={(v) =>\r\n            setFilters({\r\n              ...filters,\r\n              status: v === \"all\" ? \"\" : v,\r\n              page: 1,\r\n            })\r\n          }\r\n        >\r\n          <SelectTrigger className=\"w-36\">\r\n            <SelectValue placeholder=\"Status\" />\r\n          </SelectTrigger>\r\n\r\n          <SelectContent>\r\n            <SelectItem value=\"all\">All</SelectItem>\r\n            <SelectItem value=\"submitted\">Submitted</SelectItem>\r\n            <SelectItem value=\"under_review\">Under Review</SelectItem>\r\n            <SelectItem value=\"resolved\">Resolved</SelectItem>\r\n            <SelectItem value=\"rejected\">Rejected</SelectItem>\r\n          </SelectContent>\r\n        </Select>\r\n\r\n\r\n        <Button variant=\"outline\" onClick={refresh}>\r\n          <RefreshCcw className=\"w-4 h-4\" />\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"border rounded-xl bg-card\">\r\n        <Table>\r\n          <TableHeader>\r\n            <TableRow>\r\n              <TableHead>ID</TableHead>\r\n              <TableHead>User</TableHead>\r\n              <TableHead>Message</TableHead>\r\n              <TableHead>Status</TableHead>\r\n              <TableHead className=\"text-right\">\r\n                Actions\r\n              </TableHead>\r\n            </TableRow>\r\n          </TableHeader>\r\n\r\n          <TableBody>\r\n            {appeals.map((a) => (\r\n              <TableRow key={a.id}>\r\n                <TableCell>{a.id}</TableCell>\r\n                <TableCell>\r\n                  {a.user?.username ?? \"—\"}\r\n                </TableCell>\r\n                <TableCell className=\"max-w-xs truncate\">\r\n                  {a.message}\r\n                </TableCell>\r\n                <TableCell>\r\n                  <Badge>{a.status}</Badge>\r\n                </TableCell>\r\n                <TableCell className=\"text-right\">\r\n                  <Button\r\n                    size=\"sm\"\r\n                    onClick={() =>\r\n                      updateStatus(a.id, {\r\n                        status: \"resolved\",\r\n                      })\r\n                    }\r\n                  >\r\n                    Resolve\r\n                  </Button>\r\n                </TableCell>\r\n              </TableRow>\r\n            ))}\r\n\r\n            {!loading && appeals.length === 0 && (\r\n              <TableRow>\r\n                <TableCell\r\n                  colSpan={5}\r\n                  className=\"text-center py-6 text-muted-foreground\"\r\n                >\r\n                  No appeals found\r\n                </TableCell>\r\n              </TableRow>\r\n            )}\r\n          </TableBody>\r\n        </Table>\r\n      </div>\r\n\r\n      {/* Pagination info */}\r\n      {meta && (\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          Showing {meta.from}–{meta.to} of {meta.total}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useAppeals","appeals","setAppeals","useState","meta","setMeta","loading","setLoading","filters","setFilters","fetchAppeals","useCallback","response","getAppeals","error","toast","useEffect","id","data","updateAppeal","AdminAppealsPage","refresh","updateStatus","jsxs","jsx","Input","e","Select","v","SelectTrigger","SelectValue","SelectContent","SelectItem","Button","RefreshCcw","Table","TableHeader","TableRow","TableHead","TableBody","a","TableCell","Badge"],"mappings":"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"}