{"version":3,"file":"AdminNotificationsPage-DjE3ueQl.js","sources":["../../src/hooks/useNotifications.js","../../src/pages/admin/AdminNotificationsPage.jsx"],"sourcesContent":["import { useEffect, useState, useCallback } from \"react\";\r\nimport api from \"@/lib/axios\";\r\nimport { sendNotificationToAll } from \"@/lib/adminApi\";\r\n\r\nexport default function useNotifications() {\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [meta, setMeta] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const [filters, setFilters] = useState({\r\n    page: 1,\r\n  });\r\n\r\n  const fetchNotifications = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      const res = await api.get(\"/admin/notifications\", {\r\n        params: { page: filters.page },\r\n      });\r\n\r\n      const payload = res.data?.notifications;\r\n\r\n      setNotifications(payload?.data || []);\r\n      setMeta({\r\n        current_page: payload?.current_page,\r\n        last_page: payload?.last_page,\r\n        from: payload?.from,\r\n        to: payload?.to,\r\n        total: payload?.total,\r\n      });\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch notifications:\", err);\r\n      setNotifications([]);\r\n      setMeta(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters.page]);\r\n\r\n  useEffect(() => {\r\n    fetchNotifications();\r\n  }, [fetchNotifications]);\r\n\r\n  /* =========================\r\n     DELETE NOTIFICATION\r\n  ========================= */\r\n  const deleteNotification = async (id) => {\r\n    if (!confirm(\"Delete this notification?\")) return;\r\n\r\n    try {\r\n      await api.delete(`/admin/notifications/${id}`);\r\n      fetchNotifications();\r\n    } catch (err) {\r\n      console.error(\"Delete failed:\", err);\r\n    }\r\n  };\r\n\r\n  /* =========================\r\n     SEND TO ALL\r\n  ========================= */\r\n  const sendToAll = async () => {\r\n    const title = prompt(\"Notification title:\");\r\n    if (!title) return;\r\n\r\n    const message = prompt(\"Notification message:\");\r\n    if (!message) return;\r\n\r\n    try {\r\n      await sendNotificationToAll({\r\n        title,\r\n        message,\r\n        type: \"general\",\r\n      });\r\n\r\n      alert(\"Notification sent to all users\");\r\n      fetchNotifications();\r\n    } catch (err) {\r\n      console.error(\"Send failed:\", err);\r\n      alert(\"Failed to send notification\");\r\n    }\r\n  };\r\n\r\n  return {\r\n    notifications,\r\n    meta,\r\n    loading,\r\n    filters,\r\n    setFilters,\r\n    refresh: fetchNotifications,\r\n    deleteNotification,\r\n    sendToAll,\r\n  };\r\n}\r\n","import useNotifications from \"@/hooks/useNotifications\";\r\n\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\n\r\nimport {\r\n  RefreshCcw,\r\n  ChevronLeft,\r\n  ChevronRight,\r\n  Trash,\r\n  Edit,\r\n  Send,\r\n} from \"lucide-react\";\r\n\r\nexport default function AdminNotificationsPage() {\r\n  const {\r\n    notifications,\r\n    meta,\r\n    loading,\r\n    filters,\r\n    setFilters,\r\n    refresh,\r\n    deleteNotification,\r\n    sendToAll,\r\n  } = useNotifications();\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <h1 className=\"text-xl font-semibold\">Notifications</h1>\r\n\r\n      {/* Actions */}\r\n      <div className=\"flex justify-between items-center\">\r\n        <div className=\"flex gap-2\">\r\n          <Button variant=\"outline\" onClick={refresh}>\r\n            <RefreshCcw className=\"w-4 h-4 mr-2\" />\r\n            Refresh\r\n          </Button>\r\n\r\n          <Button onClick={sendToAll}>\r\n            <Send className=\"w-4 h-4 mr-2\" />\r\n            Send to All\r\n          </Button>\r\n        </div>\r\n\r\n        {meta && (\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button\r\n              size=\"icon\"\r\n              variant=\"outline\"\r\n              aria-label=\"Previous Page\"\r\n              disabled={meta.current_page === 1}\r\n              onClick={() =>\r\n                setFilters({ ...filters, page: meta.current_page - 1 })\r\n              }\r\n            >\r\n              <ChevronLeft className=\"w-4 h-4\" />\r\n            </Button>\r\n\r\n            <span className=\"text-sm\">\r\n              Page {meta.current_page} of {meta.last_page}\r\n            </span>\r\n\r\n            <Button\r\n              size=\"icon\"\r\n              variant=\"outline\"\r\n              aria-label=\"Next Page\"\r\n              disabled={meta.current_page === meta.last_page}\r\n              onClick={() =>\r\n                setFilters({ ...filters, page: meta.current_page + 1 })\r\n              }\r\n            >\r\n              <ChevronRight className=\"w-4 h-4\" />\r\n            </Button>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"border rounded-xl bg-card\">\r\n        <Table>\r\n          <TableHeader>\r\n            <TableRow>\r\n              <TableHead>ID</TableHead>\r\n              <TableHead>Title</TableHead>\r\n              <TableHead>Type</TableHead>\r\n              <TableHead>Read</TableHead>\r\n              <TableHead>Sent</TableHead>\r\n              <TableHead>Created</TableHead>\r\n              <TableHead className=\"text-right\">Actions</TableHead>\r\n            </TableRow>\r\n          </TableHeader>\r\n\r\n          <TableBody>\r\n            {notifications.map((n) => (\r\n              <TableRow key={n.id}>\r\n                <TableCell>{n.id}</TableCell>\r\n                <TableCell className=\"font-medium\">\r\n                  {n.title || \"—\"}\r\n                </TableCell>\r\n                <TableCell>\r\n                  <Badge variant=\"outline\">\r\n                    {n.type || \"general\"}\r\n                  </Badge>\r\n                </TableCell>\r\n                <TableCell>\r\n                  <Badge variant={n.is_read ? \"success\" : \"secondary\"}>\r\n                    {n.is_read ? \"Yes\" : \"No\"}\r\n                  </Badge>\r\n                </TableCell>\r\n                <TableCell>\r\n                  <Badge variant={n.sent ? \"success\" : \"secondary\"}>\r\n                    {n.sent ? \"Yes\" : \"No\"}\r\n                  </Badge>\r\n                </TableCell>\r\n                <TableCell>\r\n                  {new Date(n.created_at).toLocaleString()}\r\n                </TableCell>\r\n\r\n                {/* ACTIONS */}\r\n                <TableCell className=\"text-right\">\r\n                  <div className=\"flex justify-end gap-2\">\r\n                    <Button size=\"icon\" aria-label=\"Edit\" variant=\"ghost\">\r\n                      <Edit className=\"w-3 h-3\" />\r\n                    </Button>\r\n\r\n                    <Button\r\n                      size=\"icon\"\r\n                      variant=\"ghost\"\r\n                      aria-label=\"Delete\"\r\n                      onClick={() => deleteNotification(n.id)}\r\n                    >\r\n                      <Trash className=\"w-3 h-3 text-red-500\" />\r\n                    </Button>\r\n                  </div>\r\n                </TableCell>\r\n              </TableRow>\r\n            ))}\r\n\r\n            {!loading && notifications.length === 0 && (\r\n              <TableRow>\r\n                <TableCell\r\n                  colSpan={7}\r\n                  className=\"text-center py-6 text-muted-foreground\"\r\n                >\r\n                  No notifications found\r\n                </TableCell>\r\n              </TableRow>\r\n            )}\r\n\r\n            {loading && (\r\n              <TableRow>\r\n                <TableCell\r\n                  colSpan={7}\r\n                  className=\"text-center py-6 text-muted-foreground\"\r\n                >\r\n                  Loading...\r\n                </TableCell>\r\n              </TableRow>\r\n            )}\r\n          </TableBody>\r\n        </Table>\r\n      </div>\r\n\r\n      {meta && (\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          Showing {meta.from}–{meta.to} of {meta.total}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useNotifications","notifications","setNotifications","useState","meta","setMeta","loading","setLoading","filters","setFilters","fetchNotifications","useCallback","payload","api","err","useEffect","id","title","message","sendNotificationToAll","AdminNotificationsPage","refresh","deleteNotification","sendToAll","jsxs","jsx","Button","RefreshCcw","Send","ChevronLeft","ChevronRight","Table","TableHeader","TableRow","TableHead","TableBody","n","TableCell","Badge","Edit","Trash"],"mappings":"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"}