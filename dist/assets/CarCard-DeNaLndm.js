import{r as l,u as N,j as e,L as w,H as A,M as C,B as D,t as g,b as E}from"./index-DbvXYXc0.js";import{C as $,a as F}from"./card-6tZ6FSP9.js";import{B as c}from"./badge-De3gxj8m.js";import{S as b}from"./star-BJn2oNt2.js";import{U as R}from"./users-E8rCSFRH.js";import{S as M}from"./settings-C8YQ_pBF.js";import{F as _}from"./fuel-CAXBRakv.js";import{M as L}from"./message-square-LR42VQJg.js";import{E as P}from"./eye--wIqRW1l.js";import{A as S}from"./arrow-right-Deh_fvqM.js";const z=({feedbacks:t,onClose:i})=>e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl p-6 max-w-md w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Customer Feedback"}),e.jsx("button",{onClick:i,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200","aria-label":"Close feedbacks",children:"âœ•"})]}),t&&t.length>0?e.jsx("ul",{className:"space-y-4",children:t.map((s,o)=>e.jsxs("li",{className:"border-b border-gray-200 dark:border-gray-700 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(b,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:s.rating?`${s.rating}/5`:"N/A"})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:s.comments||"No comment provided."})]},o))}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 italic",children:"No feedback yet."})]})}),K=({car:t,forceFavorite:i=!1,onToggleFavoriteApi:s})=>{const[o,d]=l.useState(!1),[x,m]=l.useState(!1),[p,h]=l.useState(!1),[u,f]=l.useState(!1),{isAuthenticated:y}=N();l.useEffect(()=>{if(i){d(!0);return}d(!1)},[t?.id,i]);const v=async r=>{if(r.preventDefault(),r.stopPropagation(),!t?.id||x)return;if(!y){g.error("Please log in to save favorites.");return}if(s)return s();const n=!o;d(n),m(!0);try{await E.post(`/cars/${t.id}/favorite`),g.success(n?"Added to favorites":"Removed from favorites"),window.dispatchEvent(new Event("favoritesUpdated"))}catch(k){console.error("Favorite toggle error:",k),d(!n),g.error("Failed to update favorite. Please try again.")}finally{m(!1)}},a={id:t.id,image:t.main_image_url||t.image||"/placeholder.png",brand:t.make||t.brand||"Car",model:t.model||"Model",year:t.year||"N/A",category:t.car_category||t.type||t.category||"Standard",seats:t.seats||4,transmission:t.transmission||"Auto",fuelType:t.fuel_type||t.fuelType||"Petrol",price:t.daily_rate||t.price||0,holidayRate:t.holiday_rate||null,deposit:t.deposit||null,isDeposit:t.is_deposit||!1,feedbacks:t.feedbacks||[],popular:t.popular||!1,location:t.live_location?.address||t.location||null},j=(r=>r.startsWith("data:")||/^https?:\/\//i.test(r)||r.startsWith("/api/")?r:r.startsWith("/storage/")?`/api${r}`:`/api/storage/${r.replace(/^storage\//i,"")}`)(a.image);return e.jsxs(w,{to:`/cars/${a.id}`,className:"block group",children:[e.jsxs($,{className:"relative overflow-hidden h-full flex flex-col bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:border-[#007A76] transition-all duration-300 hover:shadow-lg hover:shadow-[#007A76]/20 hover:-translate-y-1 aspect-[2/3]",children:[e.jsxs("div",{className:"relative overflow-hidden bg-gray-100 dark:bg-gray-700",style:{height:"60%"},children:[!p&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 animate-pulse"}),e.jsx("img",{src:j,alt:`${a.brand} ${a.model}`,loading:"lazy",width:"400",height:"250",onLoad:()=>h(!0),onError:r=>{r.currentTarget.src.endsWith("/placeholder.png")||(r.currentTarget.onerror=null,r.currentTarget.src="/placeholder.png",h(!0))},className:`w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 ${p?"opacity-100":"opacity-0"}`}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/10 to-transparent opacity-50 group-hover:opacity-70 transition-opacity duration-300"}),e.jsx("button",{onClick:v,disabled:x,"aria-label":o?"Remove from favorites":"Add to favorites",className:`absolute top-1.5 right-1.5 w-7 h-7 rounded-full backdrop-blur-sm flex items-center justify-center transition-all duration-300 z-20 ${o?"bg-red-500 shadow-md":"bg-white/90 dark:bg-gray-800/90 hover:scale-110"} ${x?"opacity-70 cursor-not-allowed":""}`,children:e.jsx(A,{className:`w-3.5 h-3.5 transition-all ${o?"fill-white text-white":"text-gray-700 dark:text-gray-300"}`})}),e.jsx("div",{className:"absolute top-1.5 left-1.5 z-10",children:e.jsx(c,{className:"bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm text-[#007A76] dark:text-[#8EDC81] border border-[#007A76]/30 dark:border-[#8EDC81]/30 text-[10px] font-semibold px-1.5 py-0.5",children:a.category})}),a.popular&&e.jsx("div",{className:"absolute bottom-1.5 left-1.5 z-10",children:e.jsxs(c,{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white text-[10px] font-bold border-0 px-1.5 py-0.5 flex items-center gap-0.5",children:[e.jsx(b,{className:"w-2.5 h-2.5 fill-white"}),"Popular"]})}),e.jsx("div",{className:"absolute bottom-1.5 right-1.5 z-10",children:e.jsxs(c,{className:"bg-gradient-to-r from-[#007A76] to-[#8EDC81] text-white text-[10px] font-bold px-1.5 py-0.5",children:["$",a.price,"/day"]})})]}),e.jsxs(F,{className:"p-2 flex-grow flex flex-col",style:{height:"40%"},children:[e.jsx("div",{className:"mb-1",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-semibold text-[#007A76] dark:text-[#8EDC81] uppercase tracking-wide",children:a.brand}),e.jsx("h3",{className:"text-xs font-bold text-gray-900 dark:text-white line-clamp-1 group-hover:text-[#007A76] dark:group-hover:text-[#8EDC81] transition-colors",children:a.model})]}),e.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[e.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400",children:a.year}),a.location&&a.location.trim()!==""&&e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx(C,{className:"w-2.5 h-2.5 text-gray-400 dark:text-gray-500"}),e.jsx("p",{className:"text-[9px] text-gray-500 dark:text-gray-400 line-clamp-1",children:a.location.trim()})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 mb-1",children:[e.jsxs("div",{className:"flex flex-col items-center p-1 rounded bg-gray-50 dark:bg-gray-700/50 group-hover:bg-[#007A76]/10 dark:group-hover:bg-[#007A76]/20 transition-colors",children:[e.jsx(R,{className:"w-2.5 h-2.5 text-[#007A76] dark:text-[#8EDC81] mb-0.5"}),e.jsx("span",{className:"text-[9px] font-semibold text-gray-700 dark:text-gray-300",children:a.seats})]}),e.jsxs("div",{className:"flex flex-col items-center p-1 rounded bg-gray-50 dark:bg-gray-700/50 group-hover:bg-[#007A76]/10 dark:group-hover:bg-[#007A76]/20 transition-colors",children:[e.jsx(M,{className:"w-2.5 h-2.5 text-[#007A76] dark:text-[#8EDC81] mb-0.5"}),e.jsx("span",{className:"text-[9px] font-semibold text-gray-700 dark:text-gray-300 truncate w-full text-center",children:a.transmission.slice(0,4)})]}),e.jsxs("div",{className:"flex flex-col items-center p-1 rounded bg-gray-50 dark:bg-gray-700/50 group-hover:bg-[#007A76]/10 dark:group-hover:bg-[#007A76]/20 transition-colors",children:[e.jsx(_,{className:"w-2.5 h-2.5 text-[#007A76] dark:text-[#8EDC81] mb-0.5"}),e.jsx("span",{className:"text-[9px] font-semibold text-gray-700 dark:text-gray-300 truncate w-full text-center",children:a.fuelType.slice(0,4)})]})]}),(a.holidayRate||a.isDeposit)&&e.jsxs("div",{className:"flex items-center gap-1 mb-1 text-[9px]",children:[a.holidayRate&&e.jsxs("div",{className:"flex-1 text-center p-1 bg-gradient-to-br from-[#007A76]/10 to-[#8EDC81]/10 dark:from-[#1e5f7a]/20 dark:to-[#007A76]/20 rounded border border-[#007A76]/20",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium text-[8px] leading-tight",children:"Holiday"}),e.jsxs("p",{className:"font-bold text-[#1e5f7a] dark:text-[#8EDC81] text-[10px] leading-tight",children:["$",a.holidayRate]})]}),a.isDeposit&&e.jsxs("div",{className:"flex-1 text-center p-1 bg-amber-50 dark:bg-amber-900/20 rounded border border-amber-200 dark:border-amber-800",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium text-[8px] leading-tight",children:"Deposit"}),e.jsxs("p",{className:"font-bold text-amber-800 dark:text-amber-300 text-[10px] leading-tight",children:["$",a.deposit]})]})]}),e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),f(!0)},className:"w-full flex items-center justify-between p-1 rounded bg-gray-50 dark:bg-gray-700/50 hover:bg-[#007A76]/10 dark:hover:bg-[#007A76]/20 transition-all border border-gray-200 dark:border-gray-700 hover:border-[#007A76] group/feedback mb-1","aria-label":"Open customer feedback",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-2.5 h-2.5 text-[#007A76] dark:text-[#8EDC81]"}),e.jsx("span",{className:"text-[9px] font-semibold text-gray-900 dark:text-white",children:"Reviews"})]}),e.jsx(c,{className:"bg-gradient-to-r from-[#007A76] to-[#8EDC81] text-white text-[9px] font-bold px-1 py-0",children:a.feedbacks.length})]}),e.jsx(D,{className:"w-full bg-gradient-to-r from-[#1e5f7a] via-[#007A76] to-[#8EDC81] hover:from-[#184a5e] hover:via-[#008c88] hover:to-[#7bc876] text-white font-bold py-1.5 text-[10px] rounded-lg shadow-md hover:shadow-lg transition-all duration-300 hover:scale-[1.02] group/btn",children:e.jsxs("span",{className:"flex items-center justify-center gap-1",children:[e.jsx(P,{className:"w-2.5 h-2.5"}),"View Details",e.jsx(S,{className:"w-2.5 h-2.5 group-hover/btn:translate-x-0.5 transition-transform"})]})})]})]}),u&&e.jsx(z,{feedbacks:t.feedbacks||[],onClose:()=>f(!1)})]})};export{K as C};
