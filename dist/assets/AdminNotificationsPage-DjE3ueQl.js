import{r as o,b as g,j as e,B as l}from"./index-DbvXYXc0.js";import{a4 as b}from"./adminApi-C-vdNBvN.js";import{T as y,a as v,b as j,c as n,d as S,e as i}from"./table-Cdzf11jr.js";import{B as u}from"./badge-De3gxj8m.js";import{R as T}from"./refresh-ccw-Bj__5BR5.js";import{S as w}from"./send-DKa36EPT.js";import{C as _}from"./chevron-left-DlVhwfSE.js";import{C}from"./chevron-right-DaEW3pZI.js";import{S as A}from"./square-pen-CxEXnCdu.js";import{T as R}from"./trash-wdzd2LuX.js";function k(){const[f,t]=o.useState([]),[x,c]=o.useState(null),[h,m]=o.useState(!1),[d,p]=o.useState({page:1}),s=o.useCallback(async()=>{try{m(!0);const a=(await g.get("/admin/notifications",{params:{page:d.page}})).data?.notifications;t(a?.data||[]),c({current_page:a?.current_page,last_page:a?.last_page,from:a?.from,to:a?.to,total:a?.total})}catch(r){console.error("Failed to fetch notifications:",r),t([]),c(null)}finally{m(!1)}},[d.page]);return o.useEffect(()=>{s()},[s]),{notifications:f,meta:x,loading:h,filters:d,setFilters:p,refresh:s,deleteNotification:async r=>{if(confirm("Delete this notification?"))try{await g.delete(`/admin/notifications/${r}`),s()}catch(a){console.error("Delete failed:",a)}},sendToAll:async()=>{const r=prompt("Notification title:");if(!r)return;const a=prompt("Notification message:");if(a)try{await b({title:r,message:a,type:"general"}),alert("Notification sent to all users"),s()}catch(N){console.error("Send failed:",N),alert("Failed to send notification")}}}}function $(){const{notifications:f,meta:t,loading:x,filters:c,setFilters:h,refresh:m,deleteNotification:d,sendToAll:p}=k();return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Notifications"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",onClick:m,children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(l,{onClick:p,children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Send to All"]})]}),t&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{size:"icon",variant:"outline","aria-label":"Previous Page",disabled:t.current_page===1,onClick:()=>h({...c,page:t.current_page-1}),children:e.jsx(_,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm",children:["Page ",t.current_page," of ",t.last_page]}),e.jsx(l,{size:"icon",variant:"outline","aria-label":"Next Page",disabled:t.current_page===t.last_page,onClick:()=>h({...c,page:t.current_page+1}),children:e.jsx(C,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"border rounded-xl bg-card",children:e.jsxs(y,{children:[e.jsx(v,{children:e.jsxs(j,{children:[e.jsx(n,{children:"ID"}),e.jsx(n,{children:"Title"}),e.jsx(n,{children:"Type"}),e.jsx(n,{children:"Read"}),e.jsx(n,{children:"Sent"}),e.jsx(n,{children:"Created"}),e.jsx(n,{className:"text-right",children:"Actions"})]})}),e.jsxs(S,{children:[f.map(s=>e.jsxs(j,{children:[e.jsx(i,{children:s.id}),e.jsx(i,{className:"font-medium",children:s.title||"—"}),e.jsx(i,{children:e.jsx(u,{variant:"outline",children:s.type||"general"})}),e.jsx(i,{children:e.jsx(u,{variant:s.is_read?"success":"secondary",children:s.is_read?"Yes":"No"})}),e.jsx(i,{children:e.jsx(u,{variant:s.sent?"success":"secondary",children:s.sent?"Yes":"No"})}),e.jsx(i,{children:new Date(s.created_at).toLocaleString()}),e.jsx(i,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{size:"icon","aria-label":"Edit",variant:"ghost",children:e.jsx(A,{className:"w-3 h-3"})}),e.jsx(l,{size:"icon",variant:"ghost","aria-label":"Delete",onClick:()=>d(s.id),children:e.jsx(R,{className:"w-3 h-3 text-red-500"})})]})})]},s.id)),!x&&f.length===0&&e.jsx(j,{children:e.jsx(i,{colSpan:7,className:"text-center py-6 text-muted-foreground",children:"No notifications found"})}),x&&e.jsx(j,{children:e.jsx(i,{colSpan:7,className:"text-center py-6 text-muted-foreground",children:"Loading..."})})]})]})}),t&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",t.from,"–",t.to," of ",t.total]})]})}export{$ as default};
