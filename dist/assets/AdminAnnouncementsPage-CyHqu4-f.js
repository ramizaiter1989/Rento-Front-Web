import{r as l,j as e,B as f}from"./index-DbvXYXc0.js";import{a0 as g,a1 as N}from"./adminApi-C-vdNBvN.js";import{t as x}from"./use-toast-BTZLQfF-.js";import{T as v,a as A,b as j,c as o,d as S,e as a}from"./table-Cdzf11jr.js";import{I as b}from"./input-Bf8YvsU0.js";import{B as T}from"./badge-De3gxj8m.js";import{S as w,a as y,b as C,d as E,e as p}from"./select-895Ag1Vf.js";import{R as I}from"./refresh-ccw-Bj__5BR5.js";import{T as P}from"./trash-wdzd2LuX.js";import"./index-UZKPKpE4.js";import"./index-CB20-cGd.js";import"./Combination-B6rQ859v.js";import"./index-9AnY3iUi.js";import"./index-DXYwaiuf.js";import"./index-D66kppzp.js";import"./index-ddclwrTJ.js";import"./index-P5EQzgSd.js";import"./check-nqnuVgMJ.js";function B(){const[i,r]=l.useState([]),[h,c]=l.useState(null),[d,m]=l.useState(!0),[n,t]=l.useState({search:"",status:"",page:1}),u=l.useCallback(async()=>{m(!0);try{const s=await g({search:n.search||void 0,status:n.status||void 0,page:n.page});console.log("ANNOUNCEMENTS API RESPONSE:",s.data),r(s.data.announcements.data),c(s.data.announcements)}catch(s){console.error(s),x({title:"Failed to load announcements",variant:"destructive"})}finally{m(!1)}},[n]);return l.useEffect(()=>{u()},[u]),{announcements:i,meta:h,loading:d,filters:n,setFilters:t,refresh:()=>{u()},removeAnnouncement:async s=>{if(confirm("Delete this announcement?"))try{await N(s),x({title:"Announcement deleted"}),u()}catch{x({title:"Failed to delete announcement",variant:"destructive"})}}}}function Z(){const{announcements:i,meta:r,loading:h,filters:c,setFilters:d,refresh:m,removeAnnouncement:n}=B();return console.log("ANNOUNCEMENTS IN PAGE:",i),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Announcements"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(b,{className:"w-56",placeholder:"Search...",value:c.search,onChange:t=>d({...c,search:t.target.value,page:1})}),e.jsxs(w,{value:c.status,onValueChange:t=>d({...c,status:t,page:1}),children:[e.jsx(y,{className:"w-36",children:e.jsx(C,{placeholder:"Status"})}),e.jsxs(E,{children:[e.jsx(p,{value:"draft",children:"Draft"}),e.jsx(p,{value:"published",children:"Published"})]})]}),e.jsx(f,{variant:"outline",onClick:m,children:e.jsx(I,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"border rounded-xl bg-card",children:e.jsxs(v,{children:[e.jsx(A,{children:e.jsxs(j,{children:[e.jsx(o,{children:"ID"}),e.jsx(o,{children:"Title"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Priority"}),e.jsx(o,{children:"Audience"}),e.jsx(o,{className:"text-right",children:"Actions"})]})}),e.jsxs(S,{children:[i.map(t=>e.jsxs(j,{children:[e.jsx(a,{children:t.id}),e.jsx(a,{className:"font-medium",children:t.title}),e.jsx(a,{children:e.jsx(T,{children:t.status})}),e.jsx(a,{children:t.priority}),e.jsx(a,{children:t.target_audience?.length?t.target_audience.join(", "):"All"}),e.jsx(a,{className:"text-right",children:e.jsx(f,{size:"icon","aria-label":"Delete announcement",variant:"destructive",onClick:()=>n(t.id),children:e.jsx(P,{className:"w-3 h-3"})})})]},t.id)),!h&&i.length===0&&e.jsx(j,{children:e.jsx(a,{colSpan:6,className:"text-center py-6 text-muted-foreground",children:"No announcements found"})})]})]})}),r&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",r.from,"â€“",r.to," of ",r.total]})]})}export{Z as default};
