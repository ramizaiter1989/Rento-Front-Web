{"version":3,"file":"exportUtils-CeAGTcG1.js","sources":["../../src/utils/exportUtils.js"],"sourcesContent":["/**\r\n * Export Utilities\r\n * Functions to export data as PDF or Excel\r\n */\r\n\r\n/**\r\n * Export data to CSV/Excel format\r\n * @param {Array} data - Array of objects to export\r\n * @param {Array} columns - Array of column definitions [{key, label, transform?}, ...]\r\n * @param {string} filename - Name of the file (without extension)\r\n */\r\nexport const exportToExcel = (data, columns, filename = 'export') => {\r\n  // Create CSV content\r\n  const headers = columns.map(col => col.label || col.key).join(',');\r\n  const rows = data.map(item => {\r\n    return columns.map(col => {\r\n      let value = item[col.key];\r\n      // Apply transform if provided\r\n      if (col.transform && typeof col.transform === 'function') {\r\n        value = col.transform(item);\r\n      }\r\n      // Handle null/undefined\r\n      if (value === null || value === undefined) return '';\r\n      // Escape commas and quotes in CSV\r\n      const stringValue = String(value);\r\n      if (stringValue.includes(',') || stringValue.includes('\"') || stringValue.includes('\\n')) {\r\n        return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\r\n      }\r\n      return stringValue;\r\n    }).join(',');\r\n  });\r\n\r\n  const csvContent = [headers, ...rows].join('\\n');\r\n  \r\n  // Add BOM for Excel UTF-8 support\r\n  const BOM = '\\uFEFF';\r\n  const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  \r\n  // Create download link\r\n  const link = document.createElement('a');\r\n  const url = URL.createObjectURL(blob);\r\n  link.setAttribute('href', url);\r\n  link.setAttribute('download', `${filename}.csv`);\r\n  link.style.visibility = 'hidden';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};\r\n\r\n/**\r\n * Export data to PDF using browser print\r\n * @param {HTMLElement} element - HTML element to export\r\n * @param {string} filename - Name of the file (without extension)\r\n */\r\nexport const exportToPDF = (element, filename = 'export') => {\r\n  const printWindow = window.open('', '_blank');\r\n  printWindow.document.write(`\r\n    <html>\r\n      <head>\r\n        <title>${filename}</title>\r\n        <style>\r\n          body { font-family: Arial, sans-serif; margin: 20px; }\r\n          table { border-collapse: collapse; width: 100%; margin-top: 20px; }\r\n          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\r\n          th { background-color: #f2f2f2; font-weight: bold; }\r\n          @media print {\r\n            body { margin: 0; }\r\n            @page { margin: 1cm; }\r\n          }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        ${element.outerHTML}\r\n      </body>\r\n    </html>\r\n  `);\r\n  printWindow.document.close();\r\n  printWindow.focus();\r\n  setTimeout(() => {\r\n    printWindow.print();\r\n    printWindow.close();\r\n  }, 250);\r\n};\r\n\r\n/**\r\n * Export table data to PDF (creates a table from data array)\r\n * @param {Array} data - Array of objects to export\r\n * @param {Array} columns - Array of column definitions [{key, label}, ...]\r\n * @param {string} title - Title for the PDF\r\n * @param {string} filename - Name of the file (without extension)\r\n */\r\nexport const exportTableToPDF = (data, columns, title = 'Export', filename = 'export') => {\r\n  const tableHtml = `\r\n    <div>\r\n      <h1>${title}</h1>\r\n      <p>Generated on: ${new Date().toLocaleString()}</p>\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            ${columns.map(col => `<th>${col.label || col.key}</th>`).join('')}\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          ${data.map(item => `\r\n            <tr>\r\n              ${columns.map(col => `<td>${item[col.key] ?? ''}</td>`).join('')}\r\n            </tr>\r\n          `).join('')}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  `;\r\n  \r\n  const printWindow = window.open('', '_blank');\r\n  printWindow.document.write(`\r\n    <html>\r\n      <head>\r\n        <title>${filename}</title>\r\n        <style>\r\n          body { font-family: Arial, sans-serif; margin: 20px; }\r\n          h1 { color: #333; }\r\n          table { border-collapse: collapse; width: 100%; margin-top: 20px; }\r\n          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\r\n          th { background-color: #f2f2f2; font-weight: bold; }\r\n          @media print {\r\n            body { margin: 0; }\r\n            @page { margin: 1cm; }\r\n          }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        ${tableHtml}\r\n      </body>\r\n    </html>\r\n  `);\r\n  printWindow.document.close();\r\n  printWindow.focus();\r\n  setTimeout(() => {\r\n    printWindow.print();\r\n    printWindow.close();\r\n  }, 250);\r\n};\r\n"],"names":["exportToExcel","data","columns","filename","headers","col","rows","item","value","stringValue","csvContent","BOM","blob","link","url","exportTableToPDF","title","tableHtml","printWindow"],"mappings":"AAWY,MAACA,EAAgB,CAACC,EAAMC,EAASC,EAAW,WAAa,CAEnE,MAAMC,EAAUF,EAAQ,IAAIG,GAAOA,EAAI,OAASA,EAAI,GAAG,EAAE,KAAK,GAAG,EAC3DC,EAAOL,EAAK,IAAIM,GACbL,EAAQ,IAAIG,GAAO,CACxB,IAAIG,EAAQD,EAAKF,EAAI,GAAG,EAMxB,GAJIA,EAAI,WAAa,OAAOA,EAAI,WAAc,aAC5CG,EAAQH,EAAI,UAAUE,CAAI,GAGxBC,GAAU,KAA6B,MAAO,GAElD,MAAMC,EAAc,OAAOD,CAAK,EAChC,OAAIC,EAAY,SAAS,GAAG,GAAKA,EAAY,SAAS,GAAG,GAAKA,EAAY,SAAS;AAAA,CAAI,EAC9E,IAAIA,EAAY,QAAQ,KAAM,IAAI,CAAC,IAErCA,CACT,CAAC,EAAE,KAAK,GAAG,CACZ,EAEKC,EAAa,CAACN,EAAS,GAAGE,CAAI,EAAE,KAAK;AAAA,CAAI,EAGzCK,EAAM,SACNC,EAAO,IAAI,KAAK,CAACD,EAAMD,CAAU,EAAG,CAAE,KAAM,yBAAyB,CAAE,EAGvEG,EAAO,SAAS,cAAc,GAAG,EACjCC,EAAM,IAAI,gBAAgBF,CAAI,EACpCC,EAAK,aAAa,OAAQC,CAAG,EAC7BD,EAAK,aAAa,WAAY,GAAGV,CAAQ,MAAM,EAC/CU,EAAK,MAAM,WAAa,SACxB,SAAS,KAAK,YAAYA,CAAI,EAC9BA,EAAK,MAAK,EACV,SAAS,KAAK,YAAYA,CAAI,CAChC,EA4CaE,EAAmB,CAACd,EAAMC,EAASc,EAAQ,SAAUb,EAAW,WAAa,CACxF,MAAMc,EAAY;AAAA;AAAA,YAERD,CAAK;AAAA,yBACQ,IAAI,OAAO,gBAAgB;AAAA;AAAA;AAAA;AAAA,cAItCd,EAAQ,IAAIG,GAAO,OAAOA,EAAI,OAASA,EAAI,GAAG,OAAO,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA,YAIjEJ,EAAK,IAAIM,GAAQ;AAAA;AAAA,gBAEbL,EAAQ,IAAIG,GAAO,OAAOE,EAAKF,EAAI,GAAG,GAAK,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA,WAEnE,EAAE,KAAK,EAAE,CAAC;AAAA;AAAA;AAAA;AAAA,IAMba,EAAc,OAAO,KAAK,GAAI,QAAQ,EAC5CA,EAAY,SAAS,MAAM;AAAA;AAAA;AAAA,iBAGZf,CAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAcfc,CAAS;AAAA;AAAA;AAAA,GAGhB,EACDC,EAAY,SAAS,QACrBA,EAAY,MAAK,EACjB,WAAW,IAAM,CACfA,EAAY,MAAK,EACjBA,EAAY,MAAK,CACnB,EAAG,GAAG,CACR"}