import{r as c,j as e,B as u}from"./index-DbvXYXc0.js";import{C as v,b as _,c as C,a as y}from"./card-6tZ6FSP9.js";import{T as N,a as b,b as f,c as i,d as H,e as l}from"./table-Cdzf11jr.js";import{B as S}from"./badge-De3gxj8m.js";import{Z as w,_ as D,$ as T}from"./adminApi-C-vdNBvN.js";import{t as h}from"./use-toast-BTZLQfF-.js";import{I as o}from"./input-Bf8YvsU0.js";import{L as n}from"./label-DMFTECDG.js";import{S as I}from"./switch-D3Ete2KM.js";import{P as F}from"./plus-CKnT-f47.js";import{R as k}from"./refresh-cw-BkItMj0z.js";import{T as A}from"./trash-wdzd2LuX.js";import"./index-UZKPKpE4.js";import"./index-ddclwrTJ.js";import"./index-D66kppzp.js";const E=({onSuccess:x})=>{const[m,j]=c.useState(!1),[t,p]=c.useState({car_id:"",holiday_name:"",start:"",end:"",percentage_increase:"",is_active:!0}),r=(s,a)=>p(g=>({...g,[s]:a})),d=async s=>{s.preventDefault(),j(!0);try{await w({car_id:Number(t.car_id),holiday_name:t.holiday_name,holiday_dates:{start:t.start,end:t.end},percentage_increase:Number(t.percentage_increase),is_active:t.is_active}),h({title:"Holiday created"}),x?.()}catch{h({title:"Failed to create holiday",variant:"destructive"})}finally{j(!1)}};return e.jsxs("form",{onSubmit:d,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Car ID"}),e.jsx(o,{value:t.car_id,onChange:s=>r("car_id",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Holiday Name"}),e.jsx(o,{value:t.holiday_name,onChange:s=>r("holiday_name",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Start Date"}),e.jsx(o,{type:"date",value:t.start,onChange:s=>r("start",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{children:"End Date"}),e.jsx(o,{type:"date",value:t.end,onChange:s=>r("end",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Increase %"}),e.jsx(o,{type:"number",step:"0.01",value:t.percentage_increase,onChange:s=>r("percentage_increase",s.target.value),required:!0})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[e.jsx(I,{checked:t.is_active,onCheckedChange:s=>r("is_active",s)}),e.jsx(n,{children:"Active"})]}),e.jsx("div",{className:"md:col-span-2 flex justify-end gap-2",children:e.jsx(u,{type:"submit",disabled:m,children:m?"Saving...":"Create Holiday"})})]})},U=()=>{const[x,m]=c.useState([]),[j,t]=c.useState(!1),[p,r]=c.useState(!0),d=async()=>{r(!0);try{const a=await D();console.log("HOLIDAYS API RESPONSE:",a.data),m(a.data.holidays.data)}catch(a){console.error(a),h({title:"Failed to load holidays",variant:"destructive"})}finally{r(!1)}};c.useEffect(()=>{d()},[]);const s=async a=>{if(confirm("Delete this holiday?"))try{await T(a),h({title:"Holiday deleted"}),d()}catch{h({title:"Failed to delete holiday",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Holidays"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{size:"sm","aria-label":"Create new holiday",onClick:()=>t(a=>!a),children:[e.jsx(F,{className:"h-4 w-4 mr-1"}),"Create Holiday"]}),e.jsx(u,{size:"icon","aria-label":"refresh data",variant:"outline",onClick:d,children:e.jsx(k,{className:"h-4 w-4"})})]})]}),j&&e.jsxs(v,{children:[e.jsx(_,{children:e.jsx(C,{children:"Create Holiday"})}),e.jsx(y,{children:e.jsx(E,{onSuccess:()=>{t(!1),d()}})})]}),e.jsx(v,{children:e.jsx(y,{children:p?e.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"Loading holidays..."}):x.length===0?e.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"No holidays found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(N,{children:[e.jsx(b,{children:e.jsxs(f,{children:[e.jsx(i,{children:"ID"}),e.jsx(i,{children:"Car"}),e.jsx(i,{children:"Holiday Name"}),e.jsx(i,{children:"Dates"}),e.jsx(i,{children:"Increase %"}),e.jsx(i,{children:"Active"}),e.jsx(i,{className:"text-right",children:"Actions"})]})}),e.jsx(H,{children:x.map(a=>e.jsxs(f,{children:[e.jsx(l,{children:a.id}),e.jsxs(l,{children:[a.car?.make," ",a.car?.model]}),e.jsx(l,{children:a.holiday_name}),e.jsxs(l,{className:"text-xs",children:[a.holiday_dates.start," â†’"," ",a.holiday_dates.end]}),e.jsxs(l,{children:[a.percentage_increase,"%"]}),e.jsx(l,{children:e.jsx(S,{variant:a.is_active?"success":"secondary",children:a.is_active?"Yes":"No"})}),e.jsx(l,{className:"text-right",children:e.jsx(u,{size:"icon","aria-label":"Delete holiday",variant:"destructive",onClick:()=>s(a.id),children:e.jsx(A,{className:"h-3 w-3"})})})]},a.id))})]})})})})]})};export{U as default};
