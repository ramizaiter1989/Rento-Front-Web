{"version":3,"file":"AdminAnnouncementsPage-CyHqu4-f.js","sources":["../../src/hooks/useAnnouncements.js","../../src/pages/admin/AdminAnnouncementsPage.jsx"],"sourcesContent":["import { useEffect, useState, useCallback } from \"react\";\r\nimport { getAnnouncements, deleteAnnouncement } from \"@/lib/adminApi\";\r\nimport { toast } from \"@/hooks/use-toast\";\r\n\r\nexport default function useAnnouncements() {\r\n  const [announcements, setAnnouncements] = useState([]);\r\n  const [meta, setMeta] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [filters, setFilters] = useState({\r\n    search: \"\",\r\n    status: \"\",\r\n    page: 1,\r\n  });\r\n\r\n  const fetchAnnouncements = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await getAnnouncements({\r\n        search: filters.search || undefined,\r\n        status: filters.status || undefined,\r\n        page: filters.page,\r\n      });\r\n\r\n      console.log(\"ANNOUNCEMENTS API RESPONSE:\", response.data);\r\n\r\n      setAnnouncements(response.data.announcements.data);\r\n      setMeta(response.data.announcements);\r\n    } catch (error) {\r\n      console.error(error);\r\n      toast({\r\n        title: \"Failed to load announcements\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters]);\r\n\r\n  useEffect(() => {\r\n    fetchAnnouncements();\r\n  }, [fetchAnnouncements]);\r\n\r\n  const refresh = () => {\r\n    fetchAnnouncements();\r\n  };\r\n\r\n  const removeAnnouncement = async (id) => {\r\n    if (!confirm(\"Delete this announcement?\")) return;\r\n\r\n    try {\r\n      await deleteAnnouncement(id);\r\n      toast({ title: \"Announcement deleted\" });\r\n      fetchAnnouncements();\r\n    } catch {\r\n      toast({\r\n        title: \"Failed to delete announcement\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return {\r\n    announcements, \r\n    meta,          \r\n    loading,\r\n    filters,\r\n    setFilters,\r\n    refresh,\r\n    removeAnnouncement,\r\n  };\r\n}\r\n","import useAnnouncements from \"@/hooks/useAnnouncements\";\r\n\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\n\r\nimport {\r\n  Select,\r\n  SelectTrigger,\r\n  SelectValue,\r\n  SelectContent,\r\n  SelectItem,\r\n} from \"@/components/ui/select\";\r\n\r\nimport { RefreshCcw, Trash } from \"lucide-react\";\r\n\r\nexport default function AdminAnnouncementsPage() {\r\n  const {\r\n    announcements,       \r\n    meta,                 \r\n    loading,\r\n    filters,\r\n    setFilters,\r\n    refresh,\r\n    removeAnnouncement,   \r\n  } = useAnnouncements();\r\n\r\n  console.log(\"ANNOUNCEMENTS IN PAGE:\", announcements); \r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <h1 className=\"text-xl font-semibold\">Announcements</h1>\r\n\r\n      {/* Filters */}\r\n      <div className=\"flex gap-2 flex-wrap\">\r\n        <Input\r\n          className=\"w-56\"\r\n          placeholder=\"Search...\"\r\n          value={filters.search}\r\n          onChange={(e) =>\r\n            setFilters({ ...filters, search: e.target.value, page: 1 })\r\n          }\r\n        />\r\n\r\n        <Select\r\n          value={filters.status}\r\n          onValueChange={(v) =>\r\n            setFilters({ ...filters, status: v, page: 1 })\r\n          }\r\n        >\r\n          <SelectTrigger className=\"w-36\">\r\n            <SelectValue placeholder=\"Status\" />\r\n          </SelectTrigger>\r\n          <SelectContent>\r\n            <SelectItem value=\"draft\">Draft</SelectItem>\r\n            <SelectItem value=\"published\">Published</SelectItem>\r\n          </SelectContent>\r\n        </Select>\r\n\r\n        <Button variant=\"outline\" onClick={refresh}>\r\n          <RefreshCcw className=\"w-4 h-4\" />\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"border rounded-xl bg-card\">\r\n        <Table>\r\n          <TableHeader>\r\n            <TableRow>\r\n              <TableHead>ID</TableHead>\r\n              <TableHead>Title</TableHead>\r\n              <TableHead>Status</TableHead>\r\n              <TableHead>Priority</TableHead>\r\n              <TableHead>Audience</TableHead>\r\n              <TableHead className=\"text-right\">Actions</TableHead>\r\n            </TableRow>\r\n          </TableHeader>\r\n\r\n          <TableBody>\r\n            {announcements.map((a) => (\r\n              <TableRow key={a.id}>\r\n                <TableCell>{a.id}</TableCell>\r\n                <TableCell className=\"font-medium\">{a.title}</TableCell>\r\n                <TableCell>\r\n                  <Badge>{a.status}</Badge>\r\n                </TableCell>\r\n                <TableCell>{a.priority}</TableCell>\r\n                <TableCell>\r\n                  {a.target_audience?.length\r\n                    ? a.target_audience.join(\", \")\r\n                    : \"All\"}\r\n                </TableCell>\r\n                <TableCell className=\"text-right\">\r\n                  <Button\r\n                    size=\"icon\"\r\n                    aria-label=\"Delete announcement\"\r\n                    variant=\"destructive\"\r\n                    onClick={() => removeAnnouncement(a.id)}\r\n                  >\r\n                    <Trash className=\"w-3 h-3\" />\r\n                  </Button>\r\n                </TableCell>\r\n              </TableRow>\r\n            ))}\r\n\r\n            {!loading && announcements.length === 0 && (\r\n              <TableRow>\r\n                <TableCell\r\n                  colSpan={6}\r\n                  className=\"text-center py-6 text-muted-foreground\"\r\n                >\r\n                  No announcements found\r\n                </TableCell>\r\n              </TableRow>\r\n            )}\r\n          </TableBody>\r\n        </Table>\r\n      </div>\r\n\r\n      {/* Pagination (optional) */}\r\n      {meta && (\r\n        <div className=\"text-sm text-muted-foreground\">\r\n          Showing {meta.from}â€“{meta.to} of {meta.total}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useAnnouncements","announcements","setAnnouncements","useState","meta","setMeta","loading","setLoading","filters","setFilters","fetchAnnouncements","useCallback","response","getAnnouncements","error","toast","useEffect","id","deleteAnnouncement","AdminAnnouncementsPage","refresh","removeAnnouncement","jsxs","jsx","Input","e","Select","v","SelectTrigger","SelectValue","SelectContent","SelectItem","Button","RefreshCcw","Table","TableHeader","TableRow","TableHead","TableBody","a","TableCell","Badge","Trash"],"mappings":"8sBAIe,SAASA,GAAmB,CACzC,KAAM,CAACC,EAAeC,CAAgB,EAAIC,EAAAA,SAAS,CAAA,CAAE,EAC/C,CAACC,EAAMC,CAAO,EAAIF,EAAAA,SAAS,IAAI,EAC/B,CAACG,EAASC,CAAU,EAAIJ,EAAAA,SAAS,EAAI,EAErC,CAACK,EAASC,CAAU,EAAIN,WAAS,CACrC,OAAQ,GACR,OAAQ,GACR,KAAM,CACV,CAAG,EAEKO,EAAqBC,EAAAA,YAAY,SAAY,CACjDJ,EAAW,EAAI,EACf,GAAI,CACF,MAAMK,EAAW,MAAMC,EAAiB,CACtC,OAAQL,EAAQ,QAAU,OAC1B,OAAQA,EAAQ,QAAU,OAC1B,KAAMA,EAAQ,IACtB,CAAO,EAED,QAAQ,IAAI,8BAA+BI,EAAS,IAAI,EAExDV,EAAiBU,EAAS,KAAK,cAAc,IAAI,EACjDP,EAAQO,EAAS,KAAK,aAAa,CACrC,OAASE,EAAO,CACd,QAAQ,MAAMA,CAAK,EACnBC,EAAM,CACJ,MAAO,+BACP,QAAS,aACjB,CAAO,CACH,QAAC,CACCR,EAAW,EAAK,CAClB,CACF,EAAG,CAACC,CAAO,CAAC,EAEZQ,OAAAA,EAAAA,UAAU,IAAM,CACdN,GACF,EAAG,CAACA,CAAkB,CAAC,EAqBhB,CACL,cAAAT,EACA,KAAAG,EACA,QAAAE,EACA,QAAAE,EACA,WAAAC,EACA,QAzBc,IAAM,CACpBC,GACF,EAwBE,mBAtByB,MAAOO,GAAO,CACvC,GAAK,QAAQ,2BAA2B,EAExC,GAAI,CACF,MAAMC,EAAmBD,CAAE,EAC3BF,EAAM,CAAE,MAAO,sBAAsB,CAAE,EACvCL,GACF,MAAQ,CACNK,EAAM,CACJ,MAAO,gCACP,QAAS,aACjB,CAAO,CACH,CACF,CAUF,CACA,CC9CA,SAAwBI,GAAyB,CAC/C,KAAM,CACJ,cAAAlB,EACA,KAAAG,EACA,QAAAE,EACA,QAAAE,EACA,WAAAC,EACA,QAAAW,EACA,mBAAAC,CAAA,EACErB,EAAA,EAEJ,eAAQ,IAAI,yBAA0BC,CAAa,EAGjDqB,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,wBAAwB,SAAA,gBAAa,EAGnDD,EAAAA,KAAC,MAAA,CAAI,UAAU,uBACb,SAAA,CAAAC,EAAAA,IAACC,EAAA,CACC,UAAU,OACV,YAAY,YACZ,MAAOhB,EAAQ,OACf,SAAWiB,GACThB,EAAW,CAAE,GAAGD,EAAS,OAAQiB,EAAE,OAAO,MAAO,KAAM,EAAG,CAAA,CAAA,EAI9DH,EAAAA,KAACI,EAAA,CACC,MAAOlB,EAAQ,OACf,cAAgBmB,GACdlB,EAAW,CAAE,GAAGD,EAAS,OAAQmB,EAAG,KAAM,EAAG,EAG/C,SAAA,CAAAJ,EAAAA,IAACK,GAAc,UAAU,OACvB,eAACC,EAAA,CAAY,YAAY,SAAS,CAAA,CACpC,SACCC,EAAA,CACC,SAAA,CAAAP,EAAAA,IAACQ,EAAA,CAAW,MAAM,QAAQ,SAAA,QAAK,EAC/BR,EAAAA,IAACQ,EAAA,CAAW,MAAM,YAAY,SAAA,WAAA,CAAS,CAAA,CAAA,CACzC,CAAA,CAAA,CAAA,EAGFR,EAAAA,IAACS,EAAA,CAAO,QAAQ,UAAU,QAASZ,EACjC,SAAAG,EAAAA,IAACU,EAAA,CAAW,UAAU,SAAA,CAAU,CAAA,CAClC,CAAA,EACF,EAGAV,MAAC,MAAA,CAAI,UAAU,4BACb,gBAACW,EAAA,CACC,SAAA,CAAAX,EAAAA,IAACY,EAAA,CACC,gBAACC,EAAA,CACC,SAAA,CAAAb,EAAAA,IAACc,GAAU,SAAA,IAAA,CAAE,EACbd,EAAAA,IAACc,GAAU,SAAA,OAAA,CAAK,EAChBd,EAAAA,IAACc,GAAU,SAAA,QAAA,CAAM,EACjBd,EAAAA,IAACc,GAAU,SAAA,UAAA,CAAQ,EACnBd,EAAAA,IAACc,GAAU,SAAA,UAAA,CAAQ,EACnBd,EAAAA,IAACc,EAAA,CAAU,UAAU,aAAa,SAAA,SAAA,CAAO,CAAA,CAAA,CAC3C,CAAA,CACF,SAECC,EAAA,CACE,SAAA,CAAArC,EAAc,IAAKsC,GAClBjB,EAAAA,KAACc,EAAA,CACC,SAAA,CAAAb,EAAAA,IAACiB,EAAA,CAAW,WAAE,EAAA,CAAG,EACjBjB,EAAAA,IAACiB,EAAA,CAAU,UAAU,cAAe,WAAE,MAAM,QAC3CA,EAAA,CACC,SAAAjB,MAACkB,EAAA,CAAO,SAAAF,EAAE,OAAO,EACnB,EACAhB,EAAAA,IAACiB,EAAA,CAAW,SAAAD,EAAE,QAAA,CAAS,EACvBhB,EAAAA,IAACiB,EAAA,CACE,SAAAD,EAAE,iBAAiB,OAChBA,EAAE,gBAAgB,KAAK,IAAI,EAC3B,KAAA,CACN,EACAhB,EAAAA,IAACiB,EAAA,CAAU,UAAU,aACnB,SAAAjB,EAAAA,IAACS,EAAA,CACC,KAAK,OACL,aAAW,sBACX,QAAQ,cACR,QAAS,IAAMX,EAAmBkB,EAAE,EAAE,EAEtC,SAAAhB,EAAAA,IAACmB,EAAA,CAAM,UAAU,SAAA,CAAU,CAAA,CAAA,CAC7B,CACF,CAAA,GArBaH,EAAE,EAsBjB,CACD,EAEA,CAACjC,GAAWL,EAAc,SAAW,SACnCmC,EAAA,CACC,SAAAb,EAAAA,IAACiB,EAAA,CACC,QAAS,EACT,UAAU,yCACX,SAAA,wBAAA,CAAA,CAED,CACF,CAAA,CAAA,CAEJ,CAAA,CAAA,CACF,CAAA,CACF,EAGCpC,GACCkB,EAAAA,KAAC,MAAA,CAAI,UAAU,gCAAgC,SAAA,CAAA,WACpClB,EAAK,KAAK,IAAEA,EAAK,GAAG,OAAKA,EAAK,KAAA,CAAA,CACzC,CAAA,EAEJ,CAEJ"}