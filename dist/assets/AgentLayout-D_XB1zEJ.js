import{r as a,j as e,A as re,f as D,g as se,l as ne,c as ae,u as ie,L as P,D as ce,a as le,C as de,B as C,U as L,q as M,E as ue,G as pe,J as fe,t as F,b as me}from"./index-DbvXYXc0.js";import{u as he,P as I,c as y,a as xe}from"./index-UZKPKpE4.js";import{P as ge,h as ve,R as je,u as Ce,F as ye,D as Ne}from"./Combination-B6rQ859v.js";import{u as be}from"./index-9AnY3iUi.js";import{R as Pe,A as T,c as B,C as we,a as Ae}from"./index-DXYwaiuf.js";import{P as W}from"./index-DE3TGyh9.js";import{C as Re}from"./chart-column-Brn3O9I8.js";import{M as _e}from"./message-circle-CPCE0lxB.js";import{W as Oe}from"./wallet-CWUT53m_.js";import{P as Ee}from"./plus-CKnT-f47.js";import{F as ke}from"./file-check-BfeyCmKN.js";import{B as Se}from"./bell-B1cSwKnk.js";import{L as Le}from"./loader-circle-zgEhsu46.js";import{H as Me}from"./house-DRb9moXw.js";import"./index-D66kppzp.js";function Fe(o){const s=De(o),n=a.forwardRef((i,r)=>{const{children:c,...l}=i,d=a.Children.toArray(c),u=d.find(Te);if(u){const p=u.props.children,h=d.map(m=>m===u?a.Children.count(p)>1?a.Children.only(null):a.isValidElement(p)?p.props.children:null:m);return e.jsx(s,{...l,ref:r,children:a.isValidElement(p)?a.cloneElement(p,void 0,h):null})}return e.jsx(s,{...l,ref:r,children:c})});return n.displayName=`${o}.Slot`,n}function De(o){const s=a.forwardRef((n,i)=>{const{children:r,...c}=n;if(a.isValidElement(r)){const l=We(r),d=Be(c,r.props);return r.type!==a.Fragment&&(d.ref=i?re(i,l):l),a.cloneElement(r,d)}return a.Children.count(r)>1?a.Children.only(null):null});return s.displayName=`${o}.SlotClone`,s}var Ie=Symbol("radix.slottable");function Te(o){return a.isValidElement(o)&&typeof o.type=="function"&&"__radixId"in o.type&&o.type.__radixId===Ie}function Be(o,s){const n={...s};for(const i in s){const r=o[i],c=s[i];/^on[A-Z]/.test(i)?r&&c?n[i]=(...d)=>{const u=c(...d);return r(...d),u}:r&&(n[i]=r):i==="style"?n[i]={...r,...c}:i==="className"&&(n[i]=[r,c].filter(Boolean).join(" "))}return{...o,...n}}function We(o){let s=Object.getOwnPropertyDescriptor(o.props,"ref")?.get,n=s&&"isReactWarning"in s&&s.isReactWarning;return n?o.ref:(s=Object.getOwnPropertyDescriptor(o,"ref")?.get,n=s&&"isReactWarning"in s&&s.isReactWarning,n?o.props.ref:o.props.ref||o.ref)}var w="Popover",[$]=xe(w,[B]),N=B(),[$e,g]=$(w),z=o=>{const{__scopePopover:s,children:n,open:i,defaultOpen:r,onOpenChange:c,modal:l=!1}=o,d=N(s),u=a.useRef(null),[p,h]=a.useState(!1),[m,x]=he({prop:i,defaultProp:r??!1,onChange:c,caller:w});return e.jsx(Pe,{...d,children:e.jsx($e,{scope:s,contentId:be(),triggerRef:u,open:m,onOpenChange:x,onOpenToggle:a.useCallback(()=>x(v=>!v),[x]),hasCustomAnchor:p,onCustomAnchorAdd:a.useCallback(()=>h(!0),[]),onCustomAnchorRemove:a.useCallback(()=>h(!1),[]),modal:l,children:n})})};z.displayName=w;var V="PopoverAnchor",ze=a.forwardRef((o,s)=>{const{__scopePopover:n,...i}=o,r=g(V,n),c=N(n),{onCustomAnchorAdd:l,onCustomAnchorRemove:d}=r;return a.useEffect(()=>(l(),()=>d()),[l,d]),e.jsx(T,{...c,...i,ref:s})});ze.displayName=V;var H="PopoverTrigger",U=a.forwardRef((o,s)=>{const{__scopePopover:n,...i}=o,r=g(H,n),c=N(n),l=D(s,r.triggerRef),d=e.jsx(I.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":J(r.open),...i,ref:l,onClick:y(o.onClick,r.onOpenToggle)});return r.hasCustomAnchor?d:e.jsx(T,{asChild:!0,...c,children:d})});U.displayName=H;var A="PopoverPortal",[Ve,He]=$(A,{forceMount:void 0}),G=o=>{const{__scopePopover:s,forceMount:n,children:i,container:r}=o,c=g(A,s);return e.jsx(Ve,{scope:s,forceMount:n,children:e.jsx(W,{present:n||c.open,children:e.jsx(ge,{asChild:!0,container:r,children:i})})})};G.displayName=A;var j="PopoverContent",q=a.forwardRef((o,s)=>{const n=He(j,o.__scopePopover),{forceMount:i=n.forceMount,...r}=o,c=g(j,o.__scopePopover);return e.jsx(W,{present:i||c.open,children:c.modal?e.jsx(Ge,{...r,ref:s}):e.jsx(qe,{...r,ref:s})})});q.displayName=j;var Ue=Fe("PopoverContent.RemoveScroll"),Ge=a.forwardRef((o,s)=>{const n=g(j,o.__scopePopover),i=a.useRef(null),r=D(s,i),c=a.useRef(!1);return a.useEffect(()=>{const l=i.current;if(l)return ve(l)},[]),e.jsx(je,{as:Ue,allowPinchZoom:!0,children:e.jsx(K,{...o,ref:r,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:y(o.onCloseAutoFocus,l=>{l.preventDefault(),c.current||n.triggerRef.current?.focus()}),onPointerDownOutside:y(o.onPointerDownOutside,l=>{const d=l.detail.originalEvent,u=d.button===0&&d.ctrlKey===!0,p=d.button===2||u;c.current=p},{checkForDefaultPrevented:!1}),onFocusOutside:y(o.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1})})})}),qe=a.forwardRef((o,s)=>{const n=g(j,o.__scopePopover),i=a.useRef(!1),r=a.useRef(!1);return e.jsx(K,{...o,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{o.onCloseAutoFocus?.(c),c.defaultPrevented||(i.current||n.triggerRef.current?.focus(),c.preventDefault()),i.current=!1,r.current=!1},onInteractOutside:c=>{o.onInteractOutside?.(c),c.defaultPrevented||(i.current=!0,c.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const l=c.target;n.triggerRef.current?.contains(l)&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&r.current&&c.preventDefault()}})}),K=a.forwardRef((o,s)=>{const{__scopePopover:n,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:c,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:p,onInteractOutside:h,...m}=o,x=g(j,n),v=N(n);return Ce(),e.jsx(ye,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:r,onUnmountAutoFocus:c,children:e.jsx(Ne,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:h,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:p,onDismiss:()=>x.onOpenChange(!1),children:e.jsx(we,{"data-state":J(x.open),role:"dialog",id:x.contentId,...v,...m,ref:s,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Z="PopoverClose",Ke=a.forwardRef((o,s)=>{const{__scopePopover:n,...i}=o,r=g(Z,n);return e.jsx(I.button,{type:"button",...i,ref:s,onClick:y(o.onClick,()=>r.onOpenChange(!1))})});Ke.displayName=Z;var Ze="PopoverArrow",Je=a.forwardRef((o,s)=>{const{__scopePopover:n,...i}=o,r=N(n);return e.jsx(Ae,{...r,...i,ref:s})});Je.displayName=Ze;function J(o){return o?"open":"closed"}var Qe=z,Ye=U,Xe=G,Q=q;const eo=Qe,oo=Ye,Y=a.forwardRef(({className:o,align:s="center",sideOffset:n=4,...i},r)=>e.jsx(Xe,{children:e.jsx(Q,{ref:r,align:s,sideOffset:n,className:se("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",o),...i})}));Y.displayName=Q.displayName;const to=()=>{const o=ne(),s=ae(),{user:n,logout:i}=ie(),[r,c]=a.useState(!1),[l,d]=a.useState(!1),[u,p]=a.useState([]),[h,m]=a.useState(0),[x,v]=a.useState(!1),[X,R]=a.useState(!1);a.useEffect(()=>{const t=()=>c(window.scrollY>20);return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)},[]),a.useEffect(()=>{const t=async()=>{try{const{data:b}=await ue();m(b?.unread_count??0)}catch{}};t();const f=()=>t();return window.addEventListener("focus",f),()=>window.removeEventListener("focus",f)},[]);const ee=async()=>{v(!0);try{const{data:t}=await fe({per_page:20});let f=[];Array.isArray(t?.notifications)?f=t.notifications:Array.isArray(t?.data)?f=t.data:t?.notifications?.data&&Array.isArray(t.notifications.data)?f=t.notifications.data:Array.isArray(t)&&(f=t),p(f),typeof t?.unread_count=="number"&&m(t.unread_count)}catch{F.error("Failed to load notifications"),p([])}finally{v(!1)}},oe=async t=>{const{data:f}=t,b=f?.action,k=f?.booking_id,S=f?.booking_id;if(t.id&&!t.is_read)try{await pe({notification_ids:[t.id]}),m(te=>Math.max(0,te-1))}catch{}R(!1),b==="view_booking"&&k?s("/Mycars-bookings/detail",{state:{bookingId:k}}):b==="view_sea_vehicle_booking"&&S&&s("/Mycars-bookings",{state:{seaVehicleBookingId:S}})},_=async()=>{try{await me.post("/logout")}catch(t){console.error("Logout error:",t)}i(),F.success("Logged out successfully"),s("/")},O=[{to:"/Dashboard",label:"Dashboard",icon:ce},{to:"/Statistic",label:"Statistics",icon:Re},{to:"/Mycars",label:"My Cars",icon:le},{to:"/Mycars-bookings",label:"Bookings",icon:de},{to:"/BookingChat",label:"Chats",icon:_e},{to:"/Balance",label:"Balance",icon:Oe},{to:"/add-car",label:"Add Car",icon:Ee},{to:"/Add/car/qualification",label:"Qualifications",icon:ke}],E=t=>t==="/Dashboard"?o.pathname==="/Dashboard":o.pathname.startsWith(t);return e.jsx("nav",{className:`fixed top-0 left-0 right-0 z-50 glass-strong shadow-lg transition-all duration-300 ${r?"backdrop-blur":""}`,children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between h-16 md:h-12",children:[e.jsxs(P,{to:"/",className:"flex items-center space-x-2 group",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-transparent flex items-center justify-center hover-glow",children:e.jsx("img",{src:"/rentologo.png",alt:"Rento Logo",width:"40",height:"40",className:"rounded-lg w-10 h-10 object-contain"})}),e.jsx("span",{className:"text-xl md:text-2xl text-primary-foreground font-bold gradient-text hidden sm:block",children:"RENTO LB"})]}),e.jsx("div",{className:"hidden md:flex text-primary-foreground items-center space-x-1 flex-1 justify-center",children:O.map(t=>e.jsxs(P,{to:t.to,className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-1.5 ${E(t.to)?"bg-primary text-primary-foreground":"text-foreground/80 hover:text-foreground hover:bg-muted"}`,children:[t.icon&&e.jsx(t.icon,{className:"w-4 h-4"}),t.label]},t.to))}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(eo,{open:X,onOpenChange:t=>{R(t),t&&ee()},children:[e.jsx(oo,{asChild:!0,children:e.jsxs(C,{variant:"ghost",size:"icon",className:"hover-glow relative","aria-label":"Notifications",children:[e.jsx(Se,{className:"w-5 h-5"}),h>0&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 flex h-4 min-w-4 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white",children:h>99?"99+":h})]})}),e.jsxs(Y,{className:"w-80 md:w-96 p-0",align:"end",children:[e.jsx("div",{className:"border-b px-4 py-2 font-semibold text-sm",children:"Notifications"}),e.jsx("div",{className:"max-h-[320px] overflow-y-auto",children:x?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Le,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):!Array.isArray(u)||u.length===0?e.jsx("p",{className:"text-center py-6 text-muted-foreground text-sm",children:"No notifications"}):u.map(t=>e.jsxs("button",{type:"button",onClick:()=>oe(t),className:`w-full text-left px-4 py-3 hover:bg-muted/50 transition-colors border-b last:border-b-0 ${t.is_read?"":"bg-primary/5"}`,children:[e.jsx("p",{className:"text-sm font-medium line-clamp-1",children:t.title||"Notification"}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mt-0.5",children:t.notification_text||t.message||""}),t.time_ago&&e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:t.time_ago})]},t.id))})]})]}),e.jsx(P,{to:"/",children:e.jsx(C,{variant:"ghost",size:"icon",className:"hover-glow","aria-label":"Go to home",children:e.jsx(Me,{className:"w-5 h-5"})})}),e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-primary/10 text-primary-foreground",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:n?.username||"Agent"})]}),e.jsx(C,{variant:"ghost",size:"icon",onClick:_,className:"hover-glow hover:bg-red-500/10 hover:text-red-500","aria-label":"Logout",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"md:hidden",children:e.jsx(C,{variant:"ghost",size:"icon",onClick:()=>d(!l),className:"hover-glow","aria-label":"Menu",children:l?e.jsx("svg",{className:"w-6 h-6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M6 18L18 6M6 6l12 12"})}):e.jsx("svg",{className:"w-6 h-6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M4 6h16M4 12h16M4 18h16"})})})})]})]}),l&&e.jsx("div",{className:"md:hidden pb-4 border-t border-border/40 mt-2 pt-4",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[O.map(t=>e.jsxs(P,{to:t.to,onClick:()=>d(!1),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2 ${E(t.to)?"bg-primary text-primary-foreground":"text-foreground/80 hover:text-foreground hover:bg-muted"}`,children:[t.icon&&e.jsx(t.icon,{className:"w-4 h-4"}),t.label]},t.to)),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 mt-2",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:n?.username||"Agent"})]}),e.jsxs(C,{variant:"ghost",onClick:()=>{d(!1),_()},className:"w-full justify-start hover:bg-red-500/10 hover:text-red-500",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Logout"]})]})})]})})},jo=({children:o,noIndex:s=!1})=>e.jsxs(e.Fragment,{children:[e.jsx(to,{}),e.jsx("main",{className:"pt-16 md:pt-12 min-h-screen",children:o})]});export{jo as AgentLayout};
