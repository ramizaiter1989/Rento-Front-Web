import{c as Ze,r as h,j as e,a as E,B as b,X as se,M as X,b as Q,t as d,C as ea}from"./index-DbvXYXc0.js";import{I as x}from"./input-Bf8YvsU0.js";import{C as le,a as te,b as aa,c as sa}from"./card-6tZ6FSP9.js";import{S as w,a as C,b as S,d as M,e as i}from"./select-895Ag1Vf.js";import{B as P}from"./badge-De3gxj8m.js";import{D as la,b as ta,c as ra,d as ia,e as oa}from"./dialog-CvL19ZOf.js";import{P as na}from"./plus-CKnT-f47.js";import{E as U}from"./eye--wIqRW1l.js";import{M as re}from"./mouse-pointer-click-DbtOab9b.js";import{T as da}from"./trending-up-XqNRnPMJ.js";import{S as ye}from"./search-DsOkoVxz.js";import{m as H}from"./proxy-Rx_HuwO6.js";import{P as be}from"./pen-BGMaI_eu.js";import{T as ve}from"./trash-2-DiSdLuQ2.js";import{C as fe}from"./check-nqnuVgMJ.js";import{N as ca}from"./navigation-CqPPssKH.js";import{B as je}from"./building-2-CRipOmJR.js";import{L as ma}from"./loader-circle-zgEhsu46.js";import{G as Me}from"./gauge-Df0GzuMn.js";import{D as Ne}from"./dollar-sign-o41FEJ1i.js";import"./index-UZKPKpE4.js";import"./index-CB20-cGd.js";import"./Combination-B6rQ859v.js";import"./index-9AnY3iUi.js";import"./index-DXYwaiuf.js";import"./index-D66kppzp.js";import"./index-ddclwrTJ.js";import"./index-P5EQzgSd.js";import"./index-AD6gynWr.js";import"./index-DE3TGyh9.js";import"./use-presence-CB-MpOZZ.js";const ke=new Date().getFullYear(),_e=["available","not_available","rented","maintenance"],we=["automatic","manual"],ua=["Beirut","Mount Lebanon","North","South","Bekaa","Baalbek","Keserwan","Nabatieh","Akkar"],l={darkBlue:"#0E4C81",teal:"#008C95",limeGreen:"#8AC640",darkBlueDim:"rgba(14, 76, 129, 0.1)",tealDim:"rgba(0, 140, 149, 0.1)",limeGreenDim:"rgba(138, 198, 64, 0.1)"},V={BMW:["1 Series","3 Series","5 Series","7 Series","X1","X3","X5","X7","M3","M5","Z4","i4","i7","iX"],"Mercedes-Benz":["A-Class","C-Class","E-Class","S-Class","GLA","GLC","GLE","GLS","G-Class","AMG GT","Maybach","EQE","EQS"],Audi:["A3","A4","A6","A8","Q3","Q5","Q7","Q8","TT","R8","e-tron"],Porsche:["911","Cayenne","Macan","Panamera","Taycan","Boxster","Cayman"],Volkswagen:["Polo","Golf","Jetta","Passat","Tiguan","Touareg","Arteon","ID.4","ID.7"],Opel:["Corsa","Astra","Insignia","Mokka","Grandland"],Smart:["Fortwo","Forfour"],Ferrari:["Roma","Portofino","F8","812","SF90","Purosangue"],Lamborghini:["Huracan","Aventador","Urus","Revuelto"],Maserati:["Ghibli","Quattroporte","Levante","Grecale","MC20"],"Alfa Romeo":["Giulia","Stelvio","Tonale","Giulietta"],Fiat:["500","Panda","Tipo","Doblo"],Pagani:["Huayra","Zonda"],"Rolls-Royce":["Phantom","Ghost","Wraith","Cullinan","Spectre"],Bentley:["Continental GT","Flying Spur","Bentayga"],"Aston Martin":["Vantage","DB11","DB12","DBX","Valhalla"],Jaguar:["XE","XF","XJ","F-Type","E-Pace","F-Pace"],"Land Rover":["Range Rover","Range Rover Sport","Velar","Evoque","Defender","Discovery"],McLaren:["720S","750S","Artura","GT"],Mini:["Cooper","Countryman","Clubman"],Lotus:["Emira","Evija","Eletre"],Tesla:["Model 3","Model S","Model X","Model Y","Cybertruck","Roadster"],Ford:["Fiesta","Focus","Mustang","Explorer","Escape","Edge","F-150","Bronco"],Chevrolet:["Spark","Malibu","Camaro","Corvette","Tahoe","Suburban","Silverado"],Dodge:["Charger","Challenger","Durango"],Jeep:["Wrangler","Grand Cherokee","Compass","Renegade","Gladiator"],Cadillac:["CT4","CT5","Escalade","Lyriq"],Chrysler:["300","Pacifica"],GMC:["Sierra","Yukon","Acadia"],Rivian:["R1T","R1S"],Lucid:["Air","Gravity"],Toyota:["Corolla","Camry","Yaris","Prius","RAV4","Highlander","Land Cruiser","Supra","Hilux"],Lexus:["IS","ES","GS","LS","NX","RX","GX","LX","LC"],Honda:["Civic","Accord","City","CR-V","HR-V","Pilot","Odyssey"],Nissan:["Micra","Sentra","Altima","Maxima","Qashqai","X-Trail","GT-R","370Z"],Infiniti:["Q50","Q60","QX50","QX60","QX80"],Mazda:["Mazda2","Mazda3","Mazda6","CX-5","CX-9","MX-5"],Subaru:["Impreza","Legacy","Outback","Forester","WRX","BRZ"],Mitsubishi:["Mirage","Lancer","ASX","Outlander","Pajero"],Suzuki:["Swift","Vitara","Jimny","Baleno"],Isuzu:["D-Max","MU-X"],Hyundai:["Accent","Elantra","Sonata","Kona","Tucson","Santa Fe","Palisade","Ioniq 5"],Kia:["Rio","Cerato","K5","Soul","Sportage","Sorento","Telluride","EV6"],Genesis:["G70","G80","G90","GV70","GV80"],Peugeot:["208","308","508","2008","3008","5008"],Renault:["Clio","Megane","Talisman","Captur","Kadjar","Koleos"],Citroën:["C3","C4","C5","C5 Aircross"],Bugatti:["Chiron","Mistral","Tourbillon"],"DS Automobiles":["DS3","DS4","DS7"],BYD:["Atto 3","Han","Tang","Seal"],Geely:["Coolray","Emgrand","Tugella"],Chery:["Tiggo 7","Tiggo 8"],"Great Wall":["Haval H6","Tank 300"],NIO:["ES6","ES8","ET5","ET7"],XPeng:["P7","G6","G9"],MG:["ZS","HS","MG4","MG5"],Zeekr:["001","X"],Volvo:["S60","S90","V60","XC40","XC60","XC90"],Polestar:["Polestar 2","Polestar 3","Polestar 4"],Koenigsegg:["Jesko","Regera","Gemera"],Rimac:["Nevera"],Hennessey:["Venom F5"],SSC:["Tuatara"],Mahindra:["Scorpio","XUV700"],Tata:["Nexon","Harrier","Safari"]},xa=["Other",...Object.keys(V).sort()],ae=["White","Black","Silver","Gray","Red","Blue","Green","Yellow","Orange","Brown","Beige","Gold","Purple","Pink","Pearl White","Metallic Gray","Metallic Blue","Dark Blue","Light Blue","Burgundy"],ha=["GPS","Bluetooth","Backup Camera","Sunroof","Leather Seats","Apple CarPlay","Android Auto","Heated Seats","Cruise Control","Parking Sensors"],ga=["Child Seat","GPS Device","Phone Holder","WiFi Hotspot","Roof Rack"];function Ce(t){if(!t||typeof t!="string")return null;const u=t.trim(),n=u.match(/@(-?\d+\.?\d*),(-?\d+\.?\d*)/);if(n)return{lat:parseFloat(n[1]),lng:parseFloat(n[2])};const m=u.match(/[?&]q=(-?\d+\.?\d*),(-?\d+\.?\d*)/);if(m)return{lat:parseFloat(m[1]),lng:parseFloat(m[2])};const j=u.match(/(?:!3d|!4d|!1d)(-?\d+\.?\d*)/g);if(j&&j.length>=2){const p=parseFloat(j[0].replace(/\D/g,"")),_=parseFloat(j[1].replace(/\D/g,""));if(!isNaN(p)&&!isNaN(_))return{lat:p,lng:_}}return null}function pa(t){return!t||typeof t!="string"?!1:/^(https?:)?\/\/(maps\.app\.goo\.gl|goo\.gl\/maps)\//i.test(t.trim())}async function ya(t){try{const{data:u}=await Q.get("/resolve-map-link",{params:{url:(t||"").trim()}}),n=u?.lat??u?.latitude,m=u?.lng??u?.longitude;if(n!=null&&m!=null&&!Number.isNaN(Number(n))&&!Number.isNaN(Number(m)))return{lat:Number(n),lng:Number(m)}}catch{}return null}function Se(){try{const t=localStorage.getItem("user");if(!t)return null;let n=JSON.parse(t)?.agent?.location;if(!n)return null;typeof n=="string"&&(n=JSON.parse(n),typeof n=="string"&&(n=JSON.parse(n)));const m=n?.lat??n?.latitude,j=n?.lng??n?.longitude;return m!=null&&j!=null?{latitude:String(Number(m)),longitude:String(Number(j))}:null}catch{return null}}function ba({center:t,selectedLocation:u,onLocationSelect:n}){const m=h.useRef(null),j=h.useRef(null);h.useEffect(()=>{if(typeof window<"u"&&!window.L){const _=document.createElement("link");_.rel="stylesheet",_.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(_);const y=document.createElement("script");y.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",y.onload=()=>p(),document.head.appendChild(y)}else window.L&&p()},[]),h.useEffect(()=>{m.current&&window.L&&t?.latitude!=null&&t?.longitude!=null&&m.current.setView([parseFloat(t.latitude),parseFloat(t.longitude)],13)},[t?.latitude,t?.longitude]),h.useEffect(()=>{u&&j.current&&window.L&&j.current.setLatLng([parseFloat(u.latitude),parseFloat(u.longitude)])},[u]);const p=()=>{if(!window.L||m.current)return;const _=parseFloat(t?.latitude)||33.8547,y=parseFloat(t?.longitude)||35.8623,T=window.L.map("edit-location-map").setView([_,y],13);window.L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap"}).addTo(T);const O=window.L.marker([_,y],{draggable:!0}).addTo(T);O.on("dragend",L=>{const s=L.target.getLatLng();n(s.lat,s.lng)}),T.on("click",L=>{O.setLatLng(L.latlng),n(L.latlng.lat,L.latlng.lng)}),m.current=T,j.current=O};return e.jsx("div",{id:"edit-location-map",className:"w-full h-full min-h-[300px]"})}const va=[{value:"all",label:"All Categories"},{value:"sedan",label:"Sedan"},{value:"hatchback",label:"Hatchback"},{value:"coupe",label:"Coupe"},{value:"suv",label:"SUV"},{value:"crossover",label:"Crossover"},{value:"wagon",label:"Wagon"},{value:"pickup",label:"Pickup"},{value:"minivan",label:"Minivan"},{value:"convertible",label:"Convertible"}],fa=[{value:"all",label:"All Statuses"},{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"}],ja=t=>{switch(t){case"approved":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";default:return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}},Na=t=>{switch(t){case"luxury":return l.darkBlue;case"sport":return l.limeGreen;default:return l.teal}},ka=({car:t,onClose:u})=>{if(!t)return null;const n=m=>Array.isArray(m)?m:[];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:e.jsxs(H.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-4xl p-6 relative overflow-y-auto max-h-[90vh]",children:[e.jsx("button",{className:"absolute top-4 right-4 w-8 h-8 rounded-full flex items-center justify-center transition-all hover:scale-110",style:{background:l.tealDim},onClick:u,children:e.jsx(se,{className:"w-5 h-5",style:{color:l.teal}})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{background:`linear-gradient(135deg, ${l.teal}, ${l.darkBlue})`},children:e.jsx(E,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[t.make," ",t.model]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.year," • ",t.license_plate]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mt-4",children:[e.jsxs("div",{className:"bg-gradient-to-br p-3 rounded-xl",style:{background:l.tealDim},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(U,{className:"w-4 h-4",style:{color:l.teal}}),e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Views"})]}),e.jsx("p",{className:"text-xl font-bold",style:{color:l.teal},children:t.views_count||0})]}),e.jsxs("div",{className:"bg-gradient-to-br p-3 rounded-xl",style:{background:l.darkBlueDim},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(re,{className:"w-4 h-4",style:{color:l.darkBlue}}),e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Clicks"})]}),e.jsx("p",{className:"text-xl font-bold",style:{color:l.darkBlue},children:t.clicks_count??0})]}),e.jsxs("div",{className:"bg-gradient-to-br p-3 rounded-xl",style:{background:l.limeGreenDim},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ne,{className:"w-4 h-4",style:{color:l.limeGreen}}),e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Daily Rate"})]}),e.jsxs("p",{className:"text-xl font-bold",style:{color:l.limeGreen},children:["$",t.daily_rate]})]}),e.jsxs("div",{className:"bg-gradient-to-br p-3 rounded-xl",style:{background:l.tealDim},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ea,{className:"w-4 h-4",style:{color:l.teal}}),e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Status"})]}),e.jsx(P,{className:`text-xs ${ja(t.status)}`,children:t.status})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"relative rounded-xl overflow-hidden shadow-lg",style:{height:"240px"},children:t.main_image_url?e.jsx("img",{src:`/api/storage/${t.main_image_url}`,alt:"Main",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{background:l.tealDim},children:e.jsx(E,{className:"w-16 h-16",style:{color:l.teal,opacity:.3}})})}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:["front","back","left","right"].map(m=>t[`${m}_image_url`]?e.jsx("div",{className:"relative rounded-lg overflow-hidden shadow",style:{height:"70px"},children:e.jsx("img",{src:`/api/storage/${t[`${m}_image_url`]}`,alt:m,className:"w-full h-full object-cover"})},m):e.jsx("div",{className:"rounded-lg flex items-center justify-center",style:{height:"70px",background:l.tealDim},children:e.jsx(E,{className:"w-6 h-6",style:{color:l.teal,opacity:.3}})},m))})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsx(v,{icon:E,label:"Category",value:t.car_category}),e.jsx(v,{icon:Ne,label:"Holiday Rate",value:`$${t.holiday_rate}/day`}),e.jsx(v,{icon:Me,label:"Mileage",value:`${t.mileage?.toLocaleString()} km`}),e.jsx(v,{label:"Color",value:t.color}),e.jsx(v,{label:"Fuel Type",value:t.fuel_type}),e.jsx(v,{label:"Transmission",value:t.transmission}),e.jsx(v,{label:"Wheel Drive",value:t.wheels_drive}),e.jsx(v,{label:"Seats",value:t.seats}),e.jsx(v,{label:"Doors",value:t.doors}),e.jsx(v,{label:"Max Driving Mileage",value:`${t.max_driving_mileage} km`}),e.jsx(v,{label:"Min Rental Days",value:t.min_rental_days}),e.jsx(v,{label:"Add-Ons",value:n(t.car_add_on).join(", ")||"N/A"}),e.jsx(v,{label:"Features",value:n(t.features).join(", ")||"N/A"}),e.jsx(v,{label:"Reason for Rent",value:n(t.reason_of_rent).join(", ")||"N/A"}),t.notes&&e.jsx(v,{label:"Notes",value:t.notes}),e.jsx(v,{icon:X,label:"Delivery Location",value:t.delivery_location?.address||"N/A"}),e.jsx(v,{icon:X,label:"Return Location",value:t.return_location?.address||"N/A"}),t.live_location&&e.jsx(v,{icon:X,label:"Current Location",value:t.live_location.address,badge:!0})]})]})]})})},v=({icon:t,label:u,value:n,badge:m})=>e.jsxs("div",{className:"flex items-start gap-2 py-2 border-b border-gray-100 dark:border-gray-800",children:[t&&e.jsx(t,{className:"w-4 h-4 mt-0.5",style:{color:l.teal}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:[u,":"]}),m?e.jsx(P,{className:"ml-2 text-xs",style:{background:l.teal,color:"white"},children:n}):e.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:n})]})]}),as=()=>{const t=Ze(),[u,n]=h.useState([]),[m,j]=h.useState(!0),[p,_]=h.useState({search:"",category:"all",status:"all"}),[y,T]=h.useState(null),[O,L]=h.useState(!1),[s,ie]=h.useState({}),[Le,I]=h.useState(!1),[A,z]=h.useState(null),[oe,q]=h.useState(""),[De,ne]=h.useState(!1),[de,ce]=h.useState(""),[me,ue]=h.useState(null),Ae=async()=>{j(!0);try{const{data:a}=await Q.get("/cars/agent/Mycars",{params:{per_page:1e3}}),r=a.cars?.data??a.cars??a?.data??[];n(Array.isArray(r)?r:[])}catch{d.error("Failed to fetch cars.")}finally{j(!1)}};h.useEffect(()=>{Ae()},[]);const Y=(a,r)=>{_(c=>({...c,[a]:r}))},Fe=()=>_({search:"",category:"all",status:"all"}),[G,xe]=h.useState(null),[K,J]=h.useState(""),Te=a=>{xe(a),J("")},Z=()=>{xe(null),J("")},Re=async()=>{if(!(!G||K.toLowerCase()!=="delete"))try{await Q.delete(`/cars/${G.id}`),d.success("Car deleted successfully."),n(a=>a.filter(r=>r.id!==G.id)),Z()}catch(a){d.error(a.response?.data?.error||"Failed to delete car.")}},Ee=a=>{T(a);const r=(a.transmission||"").toLowerCase(),c=a.make&&V[a.make],g=c?V[a.make]:[],D=a.model&&g.includes(a.model),k={benz:"Petrol",diesel:"Diesel",electric:"Electric",hybrid:"Hybrid"},R=(a.fuel_type||"").toLowerCase(),F=k[R]||(["Petrol","Diesel","Electric","Hybrid"].includes(a.fuel_type)?a.fuel_type:"Petrol"),$={"4x4":"4x4",front:"Front",rear:"Rear",autoblock:"Autoblock"}[(a.wheels_drive||"").toLowerCase()]||a.wheels_drive||"";ie({make:c?a.make:"Other",customMake:c?"":a.make||"",model:D?a.model:"Other",customModel:D?"":a.model||"",year:a.year||new Date().getFullYear(),license_plate:a.license_plate||"",color:a.color||"",car_category:a.car_category||"",fuel_type:F,transmission:r==="automatic"||r==="manual"?r:"automatic",wheels_drive:$,cylinder_number:a.cylinder_number||"",seats:a.seats??5,doors:a.doors??4,daily_rate:a.daily_rate??"",holiday_rate:a.holiday_rate??"",status:_e.includes(a.status)?a.status:"available",mileage:a.mileage??"",max_driving_mileage:a.max_driving_mileage??"",notes:a.notes||"",is_deposit:!!a.is_deposit,deposit:a.deposit??"",is_delivered:!!a.is_delivered,delivery_fees:a.delivery_fees??"",with_driver:!!a.with_driver,driver_fees:a.driver_fees??"",min_rental_days:a.min_rental_days??1,insurance_expiry:a.insurance_expiry||"",registration_expiry:a.registration_expiry||"",features:Array.isArray(a.features)?a.features:[],car_add_on:Array.isArray(a.car_add_on)?a.car_add_on:[],live_location:(()=>{const f=a.live_location;if(!f)return{address:"",latitude:0,longitude:0};const Ke=f.latitude??f.lat??0,Je=f.longitude??f.lng??0;return{address:f.address??"",latitude:Number(Ke)||0,longitude:Number(Je)||0}})()}),ce(""),L(!0)},he=()=>{const a=s.make??"";return a==="Other"?String(s.customMake??"").trim():a},ge=()=>{const a=s.make??"",r=s.model??"";return a==="Other"||r==="Other"?String(s.customModel??"").trim():r},Ge=()=>{const a=he(),r=ge();if(!a)return d.error("Make is required."),!1;if(a.length>100)return d.error("Make must be at most 100 characters."),!1;if(!r)return d.error("Model is required."),!1;if(r.length>100)return d.error("Model must be at most 100 characters."),!1;const c=s.year!==void 0&&s.year!==""?Number(s.year):null;if(c!==null&&(isNaN(c)||c<1900||c>ke+1))return d.error(`Year must be between 1900 and ${ke+1}.`),!1;const g=(s.transmission||"").toLowerCase();if(g&&!we.includes(g))return d.error("Transmission must be Automatic or Manual."),!1;const D=s.status||"available";if(!_e.includes(D))return d.error("Invalid status."),!1;const k=s.daily_rate;if(k==null||k==="")return d.error("Daily rate is required."),!1;const R=Number(k);if(isNaN(R)||R<0)return d.error("Daily rate must be 0 or greater."),!1;const F=s.holiday_rate!==void 0&&s.holiday_rate!==""?Number(s.holiday_rate):null;if(F!==null&&(isNaN(F)||F<0))return d.error("Holiday rate must be 0 or greater."),!1;if(s.is_deposit){const f=Number(s.deposit);if(isNaN(f)||f<0)return d.error("Deposit amount must be 0 or greater."),!1}if(s.is_delivered){const f=Number(s.delivery_fees);if(isNaN(f)||f<0)return d.error("Delivery fees must be 0 or greater."),!1}if(s.with_driver){const f=Number(s.driver_fees);if(isNaN(f)||f<0)return d.error("Driver fees must be 0 or greater."),!1}const ee=s.min_rental_days!==void 0&&s.min_rental_days!==""?Number(s.min_rental_days):1;if(isNaN(ee)||ee<1)return d.error("Minimum rental days must be at least 1."),!1;const $=s.mileage!==void 0&&s.mileage!==""?Number(s.mileage):null;return $!==null&&(isNaN($)||$<0)?(d.error("Mileage must be 0 or greater."),!1):!0},o=(a,r)=>{ie(c=>{const g={...c,[a]:r};return a==="make"&&(g.model="",g.customModel=""),g})},Pe=a=>{const r=s.features||[],c=r.includes(a)?r.filter(g=>g!==a):[...r,a];o("features",c)},Be=a=>{const r=s.car_add_on||[],c=r.includes(a)?r.filter(g=>g!==a):[...r,a];o("car_add_on",c)},N=s.live_location||{address:"",latitude:0,longitude:0},Oe=N.latitude&&N.longitude&&Number(N.latitude)!==0&&Number(N.longitude)!==0,$e=()=>{if(!navigator.geolocation){d.error("Geolocation is not supported by your browser");return}d.info("Getting your location..."),navigator.geolocation.getCurrentPosition(a=>{o("live_location",{...N,latitude:a.coords.latitude.toFixed(6),longitude:a.coords.longitude.toFixed(6)}),d.success("Location set from current position.")},()=>d.error("Could not get your location. Please select manually."))},Ve=()=>{const a=Se();a?(o("live_location",{...N,latitude:a.latitude,longitude:a.longitude}),d.success("Location set to office.")):d.error("Office location not found. Complete your agency profile with a location first.")},Xe=()=>{z({latitude:N.latitude||33.8547,longitude:N.longitude||35.8623}),q(""),I(!0)},He=(a,r)=>{z({latitude:a.toFixed(6),longitude:r.toFixed(6)})},Ie=()=>{A&&(o("live_location",{...N,latitude:A.latitude,longitude:A.longitude}),d.success("Location selected on map.")),I(!1)},pe=async()=>{const a=oe.trim();if(a){ne(!0);try{const c=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(a)}&limit=1`,{headers:{Accept:"application/json"}})).json();c?.[0]?(z({latitude:parseFloat(c[0].lat).toFixed(6),longitude:parseFloat(c[0].lon).toFixed(6)}),d.success("Location found.")):d.error("No results found.")}catch{d.error("Search failed.")}finally{ne(!1)}}},ze=()=>{const a=Se();a?(z(a),d.success("Office location set. Confirm to use.")):d.error("Office location not found.")},We=async()=>{const a=(de||"").trim();if(!a)return;let r=Ce(a);if(!r&&pa(a)){ue("live");try{const c=await fetch(a,{redirect:"follow",method:"HEAD"});r=Ce(c?.url||a),r||(r=await ya(a))}finally{ue(null)}}r?(o("live_location",{...N,latitude:r.lat.toFixed(6),longitude:r.lng.toFixed(6)}),d.success("Location set from Google Maps link.")):d.error("Could not read coordinates. Use a link with lat,lng (e.g. @33.89,35.50 or ?q=33.89,35.50).")},Qe=async()=>{if(!y||!Ge())return;const a={},r=he(),c=ge();r&&(a.make=r),c&&(a.model=c),s.year!==void 0&&s.year!==""&&(a.year=Number(s.year)),s.license_plate!==void 0&&(a.license_plate=String(s.license_plate||"").toUpperCase().trim()),s.color!==void 0&&(a.color=s.color),s.car_category!==void 0&&(a.car_category=String(s.car_category||"").toLowerCase());const g={Petrol:"benz",Diesel:"diesel",Electric:"electric",Hybrid:"hybrid"};s.fuel_type&&(a.fuel_type=g[s.fuel_type]||s.fuel_type.toLowerCase()),s.wheels_drive&&(a.wheels_drive=String(s.wheels_drive||"").toLowerCase()),s.cylinder_number&&(a.cylinder_number=s.cylinder_number),s.seats!==void 0&&(a.seats=Number(s.seats)||5),s.doors!==void 0&&(a.doors=Number(s.doors)||4),s.max_driving_mileage!==void 0&&s.max_driving_mileage!==""&&(a.max_driving_mileage=Number(s.max_driving_mileage)),s.insurance_expiry!==void 0&&(a.insurance_expiry=s.insurance_expiry||null),s.registration_expiry!==void 0&&(a.registration_expiry=s.registration_expiry||null),Array.isArray(s.features)&&(a.features=s.features),Array.isArray(s.car_add_on)&&(a.car_add_on=s.car_add_on),s.daily_rate!==void 0&&s.daily_rate!==""&&(a.daily_rate=Number(s.daily_rate)),s.holiday_rate!==void 0&&s.holiday_rate!==""&&(a.holiday_rate=Number(s.holiday_rate)),s.status!==void 0&&(a.status=s.status);const D=(s.transmission||"").toLowerCase();D&&we.includes(D)&&(a.transmission=D),s.mileage!==void 0&&s.mileage!==""&&(a.mileage=Number(s.mileage)),s.notes!==void 0&&(a.notes=s.notes),a.is_deposit=!!s.is_deposit,s.is_deposit&&s.deposit!==void 0&&s.deposit!==""&&(a.deposit=Number(s.deposit)),a.is_delivered=!!s.is_delivered,s.is_delivered&&s.delivery_fees!==void 0&&s.delivery_fees!==""&&(a.delivery_fees=Number(s.delivery_fees)),a.with_driver=!!s.with_driver,s.with_driver&&s.driver_fees!==void 0&&s.driver_fees!==""&&(a.driver_fees=Number(s.driver_fees)),s.min_rental_days!==void 0&&s.min_rental_days!==""&&(a.min_rental_days=Math.max(1,Number(s.min_rental_days))),s.live_location&&(s.live_location.address||s.live_location.latitude||s.live_location.longitude)&&(a.live_location=s.live_location);try{const{data:k}=await Q.put(`/cars/${y.id}`,a,{headers:{"Content-Type":"application/json"}});d.success("Car updated successfully"),n(R=>R.map(F=>F.id===y.id?{...F,...k.car}:F)),L(!1)}catch(k){const R=k.response?.data?.errors?Object.values(k.response.data.errors).flat().join(", "):k.response?.data?.error||k.response?.data?.message||"Failed to update car";d.error(R)}},B=h.useMemo(()=>u.filter(a=>{const r=p.category==="all"||(a.car_category||"").toLowerCase()===p.category,c=p.status==="all"||a.status===p.status,g=[a.make,a.model,a.license_plate].some(D=>D?.toLowerCase().includes(p.search.toLowerCase()));return r&&c&&g}),[u,p]),Ue=u.reduce((a,r)=>a+(r.views_count||0),0),qe=u.reduce((a,r)=>a+(r.clicks_count||0),0),Ye=u.filter(a=>a.status==="approved").length;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50 dark:from-black dark:via-gray-900 dark:to-gray-950 pt-20",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center shadow-lg",style:{background:`linear-gradient(135deg, ${l.teal}, ${l.darkBlue})`},children:e.jsx(E,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Cars"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Manage your listed vehicles"})]})]}),e.jsxs(b,{onClick:()=>t("/add-car"),className:"h-11 rounded-xl text-white font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105",style:{background:`linear-gradient(135deg, ${l.teal}, ${l.darkBlue})`},children:[e.jsx(na,{className:"w-5 h-5 mr-2"}),"Add New Car"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(W,{icon:E,label:"Total Cars",value:u.length,gradient:`linear-gradient(135deg, ${l.teal}, ${l.darkBlue})`}),e.jsx(W,{icon:U,label:"Total Views",value:Ue,gradient:`linear-gradient(135deg, ${l.darkBlue}, ${l.teal})`}),e.jsx(W,{icon:re,label:"Total Clicks",value:qe,gradient:`linear-gradient(135deg, ${l.teal}, ${l.limeGreen})`}),e.jsx(W,{icon:da,label:"Approved",value:Ye,gradient:`linear-gradient(135deg, ${l.limeGreen}, ${l.teal})`})]}),e.jsx(le,{className:"mb-6 border-2 border-transparent shadow-lg rounded-xl",children:e.jsx(te,{className:"p-5",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 items-end",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(x,{placeholder:"Search cars...",value:p.search,onChange:a=>Y("search",a.target.value),className:"pl-9 h-10 border-2 rounded-xl transition-all duration-200",style:{borderColor:p.search?l.teal:void 0}})]})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),e.jsxs(w,{value:p.category,onValueChange:a=>Y("category",a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Select category"})}),e.jsx(M,{children:va.map(a=>e.jsx(i,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsxs(w,{value:p.status,onValueChange:a=>Y("status",a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Select status"})}),e.jsx(M,{children:fa.map(a=>e.jsx(i,{value:a.value,children:a.label},a.value))})]})]}),e.jsx("div",{className:"md:col-span-1 flex justify-end",children:(p.search||p.category!=="all"||p.status!=="all")&&e.jsx(b,{variant:"outline",className:"h-10 rounded-xl border-2",style:{borderColor:l.teal,color:l.teal},onClick:Fe,children:"Clear Filters"})})]})})}),e.jsxs(le,{className:"border-2 border-transparent shadow-lg rounded-xl",children:[e.jsx(aa,{className:"pb-4",children:e.jsxs(sa,{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Your Listed Cars (",B.length,")"]})}),e.jsx(te,{children:m?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-4 border-t-transparent",style:{borderColor:l.teal,borderTopColor:"transparent"}})}):B.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center",style:{background:l.tealDim},children:e.jsx(E,{className:"w-8 h-8",style:{color:l.teal}})}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["No cars found."," ",e.jsx(b,{variant:"link",className:"p-0 h-auto",style:{color:l.teal},onClick:()=>t("/Add/car"),children:"Add your first car"})]})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:B.map((a,r)=>{const c=a.car_accepted===!1||a.status==="pending";return e.jsxs(H.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:r*.03},className:`rounded-xl border-2 overflow-hidden bg-white dark:bg-gray-900 shadow-md hover:shadow-lg transition-shadow duration-200 ${c?"border-red-200 dark:border-red-900/50":"border-transparent"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-[4/3] w-full overflow-hidden bg-gray-100 dark:bg-gray-800",children:a.main_image_url?e.jsx("img",{src:a.main_image_url.startsWith("http")?a.main_image_url:`/api/storage/${a.main_image_url}`,alt:`${a.make} ${a.model}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{background:l.tealDim},children:e.jsx(E,{className:"w-12 h-12",style:{color:l.teal,opacity:.5}})})}),e.jsx("div",{className:"absolute top-2 right-2 flex flex-col gap-1 items-end",children:a.car_accepted===!0?e.jsx(P,{className:"bg-green-600 hover:bg-green-600 text-white text-xs font-semibold shadow",children:"Accepted"}):e.jsx(P,{className:"bg-red-600 hover:bg-red-600 text-white text-xs font-semibold shadow",children:"Not accepted"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"font-semibold text-gray-900 dark:text-white truncate",children:[a.make," ",a.model]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a.year," · ",e.jsx("span",{className:"font-mono",children:a.license_plate})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[e.jsx(P,{className:"px-2 py-0.5 text-xs text-white font-semibold shrink-0",style:{background:Na(a.car_category)},children:a.car_category}),e.jsxs("span",{className:"text-sm font-bold",style:{color:l.teal},children:["$",a.daily_rate,e.jsx("span",{className:"text-xs font-normal text-gray-500",children:"/day"})]})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",title:"Views",children:[e.jsx(U,{className:"w-3.5 h-3.5",style:{color:l.darkBlue}}),a.views_count??0]}),e.jsxs("span",{className:"flex items-center gap-1",title:"Clicks",children:[e.jsx(re,{className:"w-3.5 h-3.5",style:{color:l.teal}}),a.clicks_count??0]})]}),e.jsxs("div",{className:"mt-3 flex gap-1",children:[e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 flex-1 p-0 hover:scale-105 transition-transform",style:{color:l.teal},onClick:()=>T(a),children:e.jsx(U,{className:"w-4 h-4"})}),e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 flex-1 p-0 hover:scale-105 transition-transform",style:{color:l.darkBlue},onClick:()=>Ee(a),children:e.jsx(be,{className:"w-4 h-4"})}),e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 flex-1 p-0 text-red-600 hover:text-red-700 hover:scale-105 transition-transform",onClick:()=>Te(a),children:e.jsx(ve,{className:"w-4 h-4"})})]})]})]},a.id)})})})]}),!m&&B.length>0&&e.jsxs("p",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:["Showing all ",B.length," car",B.length!==1?"s":""]}),y&&e.jsx(ka,{car:y,onClose:()=>T(null)}),G&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:e.jsxs(H.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-md p-6 relative",children:[e.jsx("button",{type:"button",className:"absolute top-4 right-4 w-8 h-8 rounded-full flex items-center justify-center transition-all hover:scale-110",style:{background:l.tealDim},onClick:Z,children:e.jsx(se,{className:"w-5 h-5",style:{color:l.teal}})}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center bg-red-100 dark:bg-red-900/30",children:e.jsx(ve,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Delete car"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[G.make," ",G.model," (",G.license_plate,")"]})]})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["This action cannot be undone. Type ",e.jsx("strong",{className:"text-gray-900 dark:text-white",children:"delete"})," below to confirm."]}),e.jsx(x,{type:"text",value:K,onChange:a=>J(a.target.value),placeholder:"Type delete to confirm",className:"h-10 border-2 rounded-xl mb-6",autoComplete:"off"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(b,{variant:"outline",onClick:Z,className:"h-10 rounded-xl",children:"Cancel"}),e.jsx(b,{onClick:Re,disabled:K.toLowerCase()!=="delete",className:"h-10 rounded-xl text-white font-semibold bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:pointer-events-none",children:"Delete car"})]})]})}),O&&y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:e.jsxs(H.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto p-6 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 w-8 h-8 rounded-full flex items-center justify-center transition-all hover:scale-110",style:{background:l.tealDim},onClick:()=>L(!1),children:e.jsx(se,{className:"w-5 h-5",style:{color:l.teal}})}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{background:`linear-gradient(135deg, ${l.darkBlue}, ${l.teal})`},children:e.jsx(be,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Edit Car"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y.license_plate})]})]}),(y.main_image_url||y.front_image_url)&&e.jsxs("div",{className:"mb-6 p-4 rounded-xl bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-2 uppercase tracking-wider",children:"Photos (read-only)"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:["main","front","back","left","right"].map(a=>{const r=y[`${a}_image_url`]||y[`${a}_image_full_url`];if(!r)return null;const c=r.startsWith("http")?r:`/api/storage/${r}`;return e.jsx("div",{className:"w-20 h-20 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-600 shrink-0",children:e.jsx("img",{src:c,alt:a,className:"w-full h-full object-cover"})},a)})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Photos cannot be changed here."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"Basic info"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Make ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(w,{value:s.make??"",onValueChange:a=>o("make",a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Select make"})}),e.jsx(M,{children:xa.map(a=>e.jsx(i,{value:a,children:a},a))})]})]}),s.make==="Other"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Custom Make ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{value:s.customMake??"",onChange:a=>o("customMake",a.target.value),placeholder:"Type make",className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Model ",e.jsx("span",{className:"text-red-500",children:"*"})]}),s.make&&s.make!=="Other"?e.jsxs(w,{value:s.model&&V[s.make]?.includes(s.model)?s.model:s.model==="Other"?"Other":"_",onValueChange:a=>o("model",a==="_"?"":a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Select model"})}),e.jsxs(M,{children:[e.jsx(i,{value:"_",children:"Select model..."}),(V[s.make]||[]).map(a=>e.jsx(i,{value:a,children:a},a)),e.jsx(i,{value:"Other",children:"Other"})]})]}):e.jsx(x,{value:s.customModel??"",onChange:a=>o("customModel",a.target.value),placeholder:"Type model",className:"h-10 border-2 rounded-xl"})]}),s.make&&s.make!=="Other"&&s.model==="Other"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Custom Model ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{value:s.customModel??"",onChange:a=>o("customModel",a.target.value),placeholder:"Type model",className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Year"}),e.jsx(x,{type:"number",value:s.year??"",onChange:a=>o("year",a.target.value),placeholder:"e.g. 2023",className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),e.jsxs(w,{value:s.car_category||"_",onValueChange:a=>o("car_category",a==="_"?"":a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Select category"})}),e.jsxs(M,{children:[e.jsx(i,{value:"_",children:"—"}),e.jsx(i,{value:"Sedan",children:"Sedan"}),e.jsx(i,{value:"Hatchback",children:"Hatchback"}),e.jsx(i,{value:"Coupe",children:"Coupe"}),e.jsx(i,{value:"SUV",children:"SUV"}),e.jsx(i,{value:"Crossover",children:"Crossover"}),e.jsx(i,{value:"Wagon",children:"Wagon"}),e.jsx(i,{value:"Pickup",children:"Pickup"}),e.jsx(i,{value:"Minivan",children:"Minivan"}),e.jsx(i,{value:"Convertible",children:"Convertible"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Color"}),e.jsxs(w,{value:s.color||"_",onValueChange:a=>o("color",a==="_"?"":a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Select color"})}),e.jsxs(M,{children:[e.jsx(i,{value:"_",children:"—"}),(()=>{const a=s.color??"";return(a&&!ae.includes(a)?[a,...ae]:ae).map(g=>e.jsx(i,{value:g,children:g},g))})()]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"License plate"}),e.jsx(x,{value:s.license_plate??"",onChange:a=>o("license_plate",a.target.value),placeholder:"e.g. ABC 1234",className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Fuel type"}),e.jsxs(w,{value:s.fuel_type||"_",onValueChange:a=>o("fuel_type",a==="_"?"":a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Fuel type"})}),e.jsxs(M,{children:[e.jsx(i,{value:"_",children:"—"}),e.jsx(i,{value:"Petrol",children:"Petrol"}),e.jsx(i,{value:"Diesel",children:"Diesel"}),e.jsx(i,{value:"Electric",children:"Electric"}),e.jsx(i,{value:"Hybrid",children:"Hybrid"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Wheels drive"}),e.jsxs(w,{value:s.wheels_drive||"_",onValueChange:a=>o("wheels_drive",a==="_"?"":a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Wheels drive"})}),e.jsxs(M,{children:[e.jsx(i,{value:"_",children:"—"}),e.jsx(i,{value:"4x4",children:"4x4"}),e.jsx(i,{value:"Front",children:"Front"}),e.jsx(i,{value:"Rear",children:"Rear"}),e.jsx(i,{value:"Autoblock",children:"Autoblock"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Cylinder number"}),e.jsxs(w,{value:s.cylinder_number||"_",onValueChange:a=>o("cylinder_number",a==="_"?"":a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Cylinder"})}),e.jsxs(M,{children:[e.jsx(i,{value:"_",children:"—"}),e.jsx(i,{value:"4",children:"4"}),e.jsx(i,{value:"6",children:"6"}),e.jsx(i,{value:"8",children:"8"}),e.jsx(i,{value:"10",children:"10"}),e.jsx(i,{value:"12",children:"12"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Seats"}),e.jsx(x,{type:"number",min:1,max:20,value:s.seats??"",onChange:a=>o("seats",a.target.value),placeholder:"5",className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Doors"}),e.jsx(x,{type:"number",min:1,max:10,value:s.doors??"",onChange:a=>o("doors",a.target.value),placeholder:"4",className:"h-10 border-2 rounded-xl"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"Transmission"}),e.jsxs(w,{value:(s.transmission||"automatic").toLowerCase(),onValueChange:a=>o("transmission",a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Transmission"})}),e.jsxs(M,{children:[e.jsx(i,{value:"automatic",children:"Automatic"}),e.jsx(i,{value:"manual",children:"Manual"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"Status"}),e.jsxs(w,{value:s.status??"available",onValueChange:a=>o("status",a),children:[e.jsx(C,{className:"h-10 border-2 rounded-xl",children:e.jsx(S,{placeholder:"Car status"})}),e.jsxs(M,{children:[e.jsx(i,{value:"available",children:"Available"}),e.jsx(i,{value:"not_available",children:"Not available"}),e.jsx(i,{value:"rented",children:"Rented"}),e.jsx(i,{value:"maintenance",children:"Maintenance"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"Pricing & costs"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Daily rate ($) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(x,{type:"number",min:0,value:s.daily_rate??"",onChange:a=>o("daily_rate",a.target.value),placeholder:"0",className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Holiday rate ($)"}),e.jsx(x,{type:"number",min:0,value:s.holiday_rate??"",onChange:a=>o("holiday_rate",a.target.value),placeholder:"0",className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Min rental days"}),e.jsx(x,{type:"number",min:1,value:s.min_rental_days??1,onChange:a=>o("min_rental_days",a.target.value),className:"h-10 border-2 rounded-xl"})]})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:!!s.is_deposit,onChange:a=>o("is_deposit",a.target.checked),className:"w-4 h-4 rounded border-2",style:{accentColor:l.teal}}),e.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Require deposit"})]}),s.is_deposit&&e.jsxs("div",{className:"pl-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Deposit amount ($)"}),e.jsx(x,{type:"number",min:0,value:s.deposit??"",onChange:a=>o("deposit",a.target.value),placeholder:"0",className:"h-10 border-2 rounded-xl max-w-xs"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:!!s.is_delivered,onChange:a=>o("is_delivered",a.target.checked),className:"w-4 h-4 rounded border-2",style:{accentColor:l.teal}}),e.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Delivery available"})]}),s.is_delivered&&e.jsxs("div",{className:"pl-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Delivery fees ($)"}),e.jsx(x,{type:"number",min:0,value:s.delivery_fees??"",onChange:a=>o("delivery_fees",a.target.value),placeholder:"0",className:"h-10 border-2 rounded-xl max-w-xs"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:!!s.with_driver,onChange:a=>o("with_driver",a.target.checked),className:"w-4 h-4 rounded border-2",style:{accentColor:l.teal}}),e.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Driver available"})]}),s.with_driver&&e.jsxs("div",{className:"pl-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Driver fees per day ($)"}),e.jsx(x,{type:"number",min:0,value:s.driver_fees??"",onChange:a=>o("driver_fees",a.target.value),placeholder:"0",className:"h-10 border-2 rounded-xl max-w-xs"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"Features & Add-ons"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Features"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ha.map(a=>e.jsxs(P,{onClick:()=>Pe(a),className:`cursor-pointer px-3 py-1.5 text-sm transition-all ${(s.features||[]).includes(a)?"opacity-100":"opacity-60 hover:opacity-80"}`,style:{background:(s.features||[]).includes(a)?l.teal:l.tealDim,color:(s.features||[]).includes(a)?"white":"inherit"},children:[(s.features||[]).includes(a)&&e.jsx(fe,{className:"w-3 h-3 inline mr-1"}),a]},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Add-ons"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ga.map(a=>e.jsxs(P,{onClick:()=>Be(a),className:`cursor-pointer px-3 py-1.5 text-sm transition-all ${(s.car_add_on||[]).includes(a)?"opacity-100":"opacity-60 hover:opacity-80"}`,style:{background:(s.car_add_on||[]).includes(a)?l.darkBlue:l.darkBlueDim,color:(s.car_add_on||[]).includes(a)?"white":"inherit"},children:[(s.car_add_on||[]).includes(a)&&e.jsx(fe,{className:"w-3 h-3 inline mr-1"}),a]},a))})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:[e.jsx(X,{className:"w-4 h-4 inline mr-1",style:{color:l.teal}}),"Edit Location & Address"]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Address (region where car is located)"}),e.jsxs("select",{value:N.address||"",onChange:a=>o("live_location",{...N,address:a.target.value}),className:"w-full h-10 border-2 rounded-xl px-4 bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 focus:border-teal-500",children:[e.jsx("option",{value:"",children:"Select region..."}),ua.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Set coordinates using one of these options:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(b,{type:"button",variant:"outline",size:"sm",onClick:$e,className:"rounded-xl",children:[e.jsx(ca,{className:"w-4 h-4 mr-2"}),"Use Current Location"]}),e.jsxs(b,{type:"button",variant:"outline",size:"sm",onClick:Xe,className:"rounded-xl",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Select on Map"]}),e.jsxs(b,{type:"button",variant:"outline",size:"sm",onClick:Ve,className:"rounded-xl",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Office location"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600 dark:text-gray-400 mb-2",children:"Or paste Google Maps link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{placeholder:"https://www.google.com/maps/@33.89,35.50 or maps.app.goo.gl/...",value:de,onChange:a=>ce(a.target.value),className:"h-9 border-2 rounded-xl flex-1 text-sm"}),e.jsx(b,{type:"button",variant:"outline",size:"sm",disabled:me==="live",onClick:We,className:"h-9 shrink-0",children:me==="live"?e.jsx(ma,{className:"w-4 h-4 animate-spin"}):"Apply"})]})]}),Oe?e.jsxs("div",{className:"p-3 rounded-lg",style:{background:l.tealDim},children:[e.jsx("p",{className:"text-sm font-medium",style:{color:l.teal},children:"Location set"}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Lat: ",N.latitude," • Lng: ",N.longitude]})]}):e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No location selected yet."})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 mb-3 uppercase tracking-wider",children:"Other"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(Me,{className:"w-4 h-4 inline mr-1",style:{color:l.teal}}),"Mileage (km)"]}),e.jsx(x,{type:"number",min:0,value:s.mileage??"",onChange:a=>o("mileage",a.target.value),placeholder:"0",className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Max driving mileage"}),e.jsx(x,{type:"number",min:0,value:s.max_driving_mileage??"",onChange:a=>o("max_driving_mileage",a.target.value),placeholder:"Optional",className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Insurance expiry"}),e.jsx(x,{type:"date",value:s.insurance_expiry??"",onChange:a=>o("insurance_expiry",a.target.value),className:"h-10 border-2 rounded-xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Registration expiry"}),e.jsx(x,{type:"date",value:s.registration_expiry??"",onChange:a=>o("registration_expiry",a.target.value),className:"h-10 border-2 rounded-xl"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Notes"}),e.jsx("textarea",{value:s.notes??"",onChange:a=>o("notes",a.target.value),placeholder:"Optional notes about the vehicle",rows:3,className:"w-full border-2 rounded-xl p-3 bg-white dark:bg-gray-900 resize-none"})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3 sticky bottom-0 bg-white dark:bg-gray-900 pt-4 -mb-6",children:[e.jsx(b,{variant:"outline",onClick:()=>L(!1),className:"h-10 rounded-xl",children:"Cancel"}),e.jsx(b,{onClick:Qe,className:"h-10 rounded-xl text-white font-semibold",style:{background:`linear-gradient(135deg, ${l.teal}, ${l.darkBlue})`},children:"Save Changes"})]})]})}),e.jsx(la,{open:Le,onOpenChange:a=>{I(a),a||q("")},children:e.jsxs(ta,{className:"max-w-4xl max-h-[90vh]",children:[e.jsxs(ra,{children:[e.jsx(ia,{children:"Choose location on map"}),e.jsx(oa,{children:"Search or click on the map. Drag the marker to adjust. Confirm to save."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"flex flex-1 min-w-[200px] rounded-lg overflow-hidden border-2 border-gray-200 dark:border-gray-700",children:[e.jsx(x,{placeholder:"Search address or place...",value:oe,onChange:a=>q(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),pe())},className:"rounded-r-none border-0 h-11"}),e.jsx(b,{type:"button",variant:"secondary",onClick:pe,disabled:De,className:"rounded-l-none h-11 px-4",children:e.jsx(ye,{className:"w-4 h-4"})})]}),e.jsxs(b,{type:"button",variant:"outline",onClick:ze,className:"h-11 shrink-0",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Office location"]})]}),e.jsx("div",{className:"w-full h-[400px] bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden",children:A&&e.jsx(ba,{center:A,selectedLocation:A,onLocationSelect:He})}),A&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Selected: ",A.latitude,", ",A.longitude]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(b,{variant:"outline",onClick:()=>I(!1),children:"Cancel"}),e.jsx(b,{onClick:Ie,children:"Confirm Location"})]})]})]})})]})})},W=({icon:t,label:u,value:n,gradient:m})=>e.jsx(H.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:e.jsx(le,{className:"border-2 border-transparent hover:shadow-lg transition-all duration-300 rounded-xl",children:e.jsx(te,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center shadow-md",style:{background:m},children:e.jsx(t,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:u}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n})]})]})})})});export{as as MyCarsPage};
