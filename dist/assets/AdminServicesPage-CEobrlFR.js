import{r as t,t as l,j as e,B as x}from"./index-DbvXYXc0.js";import{f as Z,j as ee,n as se,r as ae,i as re,m as ce,q as ie,s as te}from"./adminApi-C-vdNBvN.js";import{C as j,a as p,b as le,c as ne}from"./card-6tZ6FSP9.js";import{B as _}from"./badge-De3gxj8m.js";import{I as V}from"./input-Bf8YvsU0.js";import{T as S,a as w,b as i,c,d as C,e as r}from"./table-Cdzf11jr.js";import{S as O,a as M,b as q,d as U,e as m}from"./select-895Ag1Vf.js";import{T as de,a as oe,b as A,c as b}from"./tabs-C3_ONro2.js";import{A as he,a as xe,b as me,c as je,d as pe,e as ue,f as ve,g as ge}from"./alert-dialog-iBykHA9-.js";import{B as fe}from"./briefcase-BYt3mvcU.js";import{B as ye}from"./building-2-CRipOmJR.js";import{P as Y}from"./package-DnittsAY.js";import{M as Ne}from"./message-circle-CPCE0lxB.js";import{R as k}from"./refresh-cw-BkItMj0z.js";import{S as G}from"./star-BJn2oNt2.js";import{T as D}from"./trash-2-DiSdLuQ2.js";import"./index-UZKPKpE4.js";import"./index-CB20-cGd.js";import"./Combination-B6rQ859v.js";import"./index-9AnY3iUi.js";import"./index-DXYwaiuf.js";import"./index-D66kppzp.js";import"./index-ddclwrTJ.js";import"./index-P5EQzgSd.js";import"./check-nqnuVgMJ.js";import"./index-B1ZSOLeI.js";import"./index-DE3TGyh9.js";import"./index-AD6gynWr.js";function Qe(){const[T,R]=t.useState([]),[B,z]=t.useState([]),[L,u]=t.useState([]),[E,$]=t.useState([]),[v,h]=t.useState(!1),[n,J]=t.useState(""),[o,F]=t.useState({services:{search:"",category:"all"},thirdParties:{search:""}}),[g,H]=t.useState({open:!1,title:"",message:"",onConfirm:null}),f=t.useCallback(async()=>{h(!0);try{const s={};o.services.search&&(s.search=o.services.search),o.services.category!=="all"&&(s.category=o.services.category);const a=await Z({...s,per_page:100}),d=a.data?.data??a.data?.services??a.data;R(Array.isArray(d)?d:[])}catch(s){console.error(s),l.error("Failed to load services"),R([])}finally{h(!1)}},[o.services.search,o.services.category]),I=t.useCallback(async()=>{h(!0);try{const s=await ee({per_page:100}),a=s.data?.data??s.data?.third_parties??s.data;z(Array.isArray(a)?a:[])}catch(s){console.error(s),l.error("Failed to load third parties"),z([])}finally{h(!1)}},[]),y=t.useCallback(async s=>{if(!s){u([]);return}h(!0);try{const a=await se(parseInt(s,10)),d=a.data?.data??a.data?.items??a.data;u(Array.isArray(d)?d:[])}catch(a){console.error(a),u([])}finally{h(!1)}},[]),P=t.useCallback(async()=>{h(!0);try{const s=await ae({per_page:100}),a=s.data?.data??s.data?.feedbacks??s.data;$(Array.isArray(a)?a:[])}catch(s){console.error(s),l.error("Failed to load feedbacks"),$([])}finally{h(!1)}},[]);t.useEffect(()=>{f()},[f]),t.useEffect(()=>{n?y(n):u([])},[n,y]);const N=(s,a,d)=>{H({open:!0,title:s,message:a,onConfirm:d})},K=s=>{N("Delete Service",`Delete "${s.name}"?`,async()=>{try{await re(s.id),l.success("Service deleted"),f()}catch(a){l.error(a.response?.data?.message||"Failed")}})},Q=s=>{N("Delete Third Party","Are you sure?",async()=>{try{await ce(s.id),l.success("Third party deleted"),I()}catch(a){l.error(a.response?.data?.message||"Failed")}})},W=s=>{N("Delete Item",`Delete "${s.name}"?`,async()=>{try{await ie(s.id),l.success("Item deleted"),n&&y(n)}catch(a){l.error(a.response?.data?.message||"Failed")}})},X=s=>{N("Delete Feedback","Are you sure?",async()=>{try{await te(s.id),l.success("Feedback deleted"),P()}catch(a){l.error(a.response?.data?.message||"Failed")}})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Services"}),e.jsxs(de,{defaultValue:"services-list",className:"w-full",children:[e.jsxs(oe,{className:"grid w-full grid-cols-4 mb-4",children:[e.jsxs(A,{value:"services-list",children:[e.jsx(fe,{className:"w-4 h-4 mr-1"})," Services"]}),e.jsxs(A,{value:"third-parties",onClick:()=>I(),children:[e.jsx(ye,{className:"w-4 h-4 mr-1"})," Third Parties"]}),e.jsxs(A,{value:"service-items",children:[e.jsx(Y,{className:"w-4 h-4 mr-1"})," Service Items"]}),e.jsxs(A,{value:"service-feedbacks",onClick:()=>P(),children:[e.jsx(Ne,{className:"w-4 h-4 mr-1"})," Feedbacks"]})]}),e.jsxs(b,{value:"services-list",className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(V,{placeholder:"Search services...",value:o.services.search,onChange:s=>F(a=>({...a,services:{...a.services,search:s.target.value}})),className:"w-48"}),e.jsxs(O,{value:o.services.category,onValueChange:s=>F(a=>({...a,services:{...a.services,category:s}})),children:[e.jsx(M,{className:"w-40",children:e.jsx(q,{placeholder:"Category"})}),e.jsxs(U,{children:[e.jsx(m,{value:"all",children:"All"}),e.jsx(m,{value:"transport",children:"Transport"}),e.jsx(m,{value:"accommodation",children:"Accommodation"}),e.jsx(m,{value:"food",children:"Food"}),e.jsx(m,{value:"entertainment",children:"Entertainment"}),e.jsx(m,{value:"other",children:"Other"})]})]}),e.jsx(x,{variant:"outline",size:"icon",onClick:f,"aria-label":"Refresh",children:e.jsx(k,{className:"w-4 h-4"})})]}),e.jsx(j,{children:e.jsx(p,{className:"p-0",children:e.jsxs(S,{children:[e.jsx(w,{children:e.jsxs(i,{children:[e.jsx(c,{children:"ID"}),e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Owner"}),e.jsx(c,{children:"Category"}),e.jsx(c,{children:"Price"}),e.jsx(c,{children:"Rating"}),e.jsx(c,{children:"Featured"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(C,{children:v?e.jsx(i,{children:e.jsx(r,{colSpan:8,className:"text-center py-8",children:"Loading..."})}):T.length===0?e.jsx(i,{children:e.jsx(r,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No services found"})}):T.map(s=>e.jsxs(i,{children:[e.jsx(r,{children:s.id}),e.jsx(r,{className:"font-medium",children:s.name}),e.jsx(r,{children:s.third_party?s.third_party.name||s.third_party.email:s.third_party_id||"—"}),e.jsx(r,{children:e.jsx(_,{variant:"outline",children:s.category||"—"})}),e.jsxs(r,{children:["$",(parseFloat(s.price)||0).toFixed(2)]}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),s.rating?Number(s.rating).toFixed(1):"N/A"]})}),e.jsx(r,{children:e.jsx(_,{variant:s.featured?"default":"secondary",children:s.featured?"Yes":"No"})}),e.jsx(r,{children:e.jsx(x,{variant:"ghost",size:"sm",className:"text-destructive",onClick:()=>K(s),children:e.jsx(D,{className:"w-4 h-4"})})})]},s.id))})]})})})]}),e.jsxs(b,{value:"third-parties",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{placeholder:"Search third parties...",value:o.thirdParties.search,onChange:s=>F(a=>({...a,thirdParties:{...a.thirdParties,search:s.target.value}})),className:"w-64"}),e.jsx(x,{variant:"outline",size:"icon",onClick:I,"aria-label":"Refresh",children:e.jsx(k,{className:"w-4 h-4"})})]}),e.jsx(j,{children:e.jsx(p,{className:"p-0",children:e.jsxs(S,{children:[e.jsx(w,{children:e.jsxs(i,{children:[e.jsx(c,{children:"ID"}),e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Contact"}),e.jsx(c,{children:"Category"}),e.jsx(c,{children:"City"}),e.jsx(c,{children:"Subscription"}),e.jsx(c,{children:"Created"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(C,{children:v?e.jsx(i,{children:e.jsx(r,{colSpan:8,className:"text-center py-8",children:"Loading..."})}):B.length===0?e.jsx(i,{children:e.jsx(r,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"No third parties found"})}):B.map(s=>e.jsxs(i,{children:[e.jsx(r,{children:s.id}),e.jsx(r,{className:"font-medium",children:s.name}),e.jsx(r,{children:s.email||s.phone||"—"}),e.jsx(r,{children:e.jsx(_,{variant:"outline",children:s.category||"—"})}),e.jsx(r,{children:s.city||"—"}),e.jsx(r,{children:s.subscription_status||"—"}),e.jsx(r,{children:s.created_at?new Date(s.created_at).toLocaleDateString():"—"}),e.jsx(r,{children:e.jsx(x,{variant:"ghost",size:"sm",className:"text-destructive",onClick:()=>Q(s),children:e.jsx(D,{className:"w-4 h-4"})})})]},s.id))})]})})})]}),e.jsxs(b,{value:"service-items",className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(O,{value:n,onValueChange:s=>J(s),children:[e.jsx(M,{className:"w-64",children:e.jsx(q,{placeholder:"Select a service to view items"})}),e.jsx(U,{children:T.map(s=>e.jsx(m,{value:String(s.id),children:s.name},s.id))})]}),n&&e.jsx(x,{variant:"outline",size:"icon",onClick:()=>y(n),"aria-label":"Refresh",children:e.jsx(k,{className:"w-4 h-4"})})]}),n?e.jsxs(j,{children:[e.jsx(le,{children:e.jsxs(ne,{children:["Items for Service #",n]})}),e.jsx(p,{className:"p-0",children:e.jsxs(S,{children:[e.jsx(w,{children:e.jsxs(i,{children:[e.jsx(c,{children:"ID"}),e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Description"}),e.jsx(c,{children:"Price"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(C,{children:v?e.jsx(i,{children:e.jsx(r,{colSpan:5,className:"text-center py-8",children:"Loading..."})}):L.length===0?e.jsx(i,{children:e.jsx(r,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No items found"})}):L.map(s=>e.jsxs(i,{children:[e.jsx(r,{children:s.id}),e.jsx(r,{className:"font-medium",children:s.name}),e.jsx(r,{className:"max-w-xs truncate",children:s.description||"N/A"}),e.jsxs(r,{children:["$",(parseFloat(s.price)||0).toFixed(2)]}),e.jsx(r,{children:e.jsx(x,{variant:"ghost",size:"sm",className:"text-destructive",onClick:()=>W(s),children:e.jsx(D,{className:"w-4 h-4"})})})]},s.id))})]})})]}):e.jsx(j,{children:e.jsxs(p,{className:"py-12 text-center text-muted-foreground",children:[e.jsx(Y,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Select a service from the dropdown above"})]})})]}),e.jsxs(b,{value:"service-feedbacks",className:"space-y-4",children:[e.jsx(x,{variant:"outline",size:"icon",onClick:P,"aria-label":"Refresh",children:e.jsx(k,{className:"w-4 h-4"})}),e.jsx(j,{children:e.jsx(p,{className:"p-0",children:e.jsxs(S,{children:[e.jsx(w,{children:e.jsxs(i,{children:[e.jsx(c,{children:"ID"}),e.jsx(c,{children:"Service"}),e.jsx(c,{children:"User"}),e.jsx(c,{children:"Rating"}),e.jsx(c,{children:"Comment"}),e.jsx(c,{children:"Created"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(C,{children:v?e.jsx(i,{children:e.jsx(r,{colSpan:7,className:"text-center py-8",children:"Loading..."})}):E.length===0?e.jsx(i,{children:e.jsx(r,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No feedbacks found"})}):E.map(s=>e.jsxs(i,{children:[e.jsx(r,{children:s.id}),e.jsx(r,{children:s.service?.name||s.service_id}),e.jsx(r,{children:s.user?.name||s.user_id}),e.jsx(r,{children:e.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((a,d)=>e.jsx(G,{className:`w-4 h-4 ${d<(s.rating||0)?"text-yellow-500 fill-yellow-500":"text-gray-300"}`},d))})}),e.jsx(r,{className:"max-w-xs truncate",children:s.comment||"N/A"}),e.jsx(r,{children:s.created_at?new Date(s.created_at).toLocaleDateString():"—"}),e.jsx(r,{children:e.jsx(x,{variant:"ghost",size:"sm",className:"text-destructive",onClick:()=>X(s),children:e.jsx(D,{className:"w-4 h-4"})})})]},s.id))})]})})})]})]}),e.jsx(he,{open:g.open,onOpenChange:s=>H(a=>({...a,open:s})),children:e.jsxs(xe,{children:[e.jsxs(me,{children:[e.jsx(je,{children:g.title}),e.jsx(pe,{children:g.message})]}),e.jsxs(ue,{children:[e.jsx(ve,{children:"Cancel"}),e.jsx(ge,{onClick:g.onConfirm,children:"Confirm"})]})]})})]})}export{Qe as default};
