import{d as ke,c as Le,r as a,t as w,j as e,B as p}from"./index-DbvXYXc0.js";import{e as Be,a5 as Ie,a6 as Fe,a7 as Me,a8 as Ee}from"./adminApi-C-vdNBvN.js";import{T as Oe,a as Ae,b as k,c as n,d as Re,e as r}from"./table-Cdzf11jr.js";import{C as b,a as v,b as me,c as xe}from"./card-6tZ6FSP9.js";import{I as V}from"./input-Bf8YvsU0.js";import{L as f}from"./label-DMFTECDG.js";import{S as L,a as B,b as I,d as F,e as o}from"./select-895Ag1Vf.js";import{B as S}from"./badge-De3gxj8m.js";import{D as ze,b as Ge,c as Ue,d as Ke}from"./dialog-CvL19ZOf.js";import{K as Z}from"./key-round-Wdy0QvLf.js";import{L as M}from"./loader-circle-zgEhsu46.js";import{C as H}from"./chart-column-Brn3O9I8.js";import{W as Ve}from"./wallet-CWUT53m_.js";import{R as ue}from"./refresh-ccw-Bj__5BR5.js";import{U as He}from"./user-check-CXyQ1CX7.js";import{F as he}from"./file-check-BfeyCmKN.js";import{E as qe}from"./eye--wIqRW1l.js";import{C as Ye}from"./chevron-left-DlVhwfSE.js";import{C as $e}from"./chevron-right-DaEW3pZI.js";import"./index-UZKPKpE4.js";import"./index-CB20-cGd.js";import"./Combination-B6rQ859v.js";import"./index-9AnY3iUi.js";import"./index-DXYwaiuf.js";import"./index-D66kppzp.js";import"./index-ddclwrTJ.js";import"./index-P5EQzgSd.js";import"./check-nqnuVgMJ.js";import"./index-AD6gynWr.js";import"./index-DE3TGyh9.js";const We=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Ze=ke("user-x",We),J={20:"Delivered",21:"Not delivered",22:"Waiting"},h={1:"USA / Canada",7:"Russia / Kazakhstan",20:"Egypt",27:"South Africa",30:"Greece",31:"Netherlands",32:"Belgium",33:"France",34:"Spain",36:"Hungary",39:"Italy",40:"Romania",41:"Switzerland",43:"Austria",44:"United Kingdom",45:"Denmark",46:"Sweden",47:"Norway",48:"Poland",49:"Germany",51:"Peru",52:"Mexico",53:"Cuba",54:"Argentina",55:"Brazil",56:"Chile",57:"Colombia",58:"Venezuela",60:"Malaysia",61:"Australia",62:"Indonesia",63:"Philippines",64:"New Zealand",65:"Singapore",66:"Thailand",81:"Japan",82:"South Korea",84:"Vietnam",86:"China",90:"Turkey",91:"India",92:"Pakistan",93:"Afghanistan",94:"Sri Lanka",95:"Myanmar",98:"Iran",212:"Morocco",213:"Algeria",216:"Tunisia",218:"Libya",220:"Gambia",221:"Senegal",222:"Mauritania",223:"Mali",224:"Guinea",225:"Ivory Coast",226:"Burkina Faso",227:"Niger",228:"Togo",229:"Benin",230:"Mauritius",231:"Liberia",232:"Sierra Leone",233:"Ghana",234:"Nigeria",235:"Chad",236:"Central African Republic",237:"Cameroon",238:"Cape Verde",239:"São Tomé and Príncipe",240:"Equatorial Guinea",241:"Gabon",242:"Republic of the Congo",243:"DR Congo",244:"Angola",245:"Guinea-Bissau",246:"British Indian Ocean Territory",248:"Seychelles",249:"Sudan",250:"Rwanda",251:"Ethiopia",252:"Somalia",253:"Djibouti",254:"Kenya",255:"Tanzania",256:"Uganda",257:"Burundi",258:"Mozambique",260:"Zambia",261:"Madagascar",262:"Réunion / Mayotte",263:"Zimbabwe",264:"Namibia",265:"Malawi",266:"Lesotho",267:"Botswana",268:"Eswatini",269:"Comoros",290:"Saint Helena",291:"Eritrea",297:"Aruba",298:"Faroe Islands",299:"Greenland",350:"Gibraltar",351:"Portugal",352:"Luxembourg",353:"Ireland",354:"Iceland",355:"Albania",356:"Malta",357:"Cyprus",358:"Finland",359:"Bulgaria",370:"Lithuania",371:"Latvia",372:"Estonia",373:"Moldova",374:"Armenia",375:"Belarus",376:"Andorra",377:"Monaco",378:"San Marino",380:"Ukraine",381:"Serbia",382:"Montenegro",383:"Kosovo",385:"Croatia",386:"Slovenia",387:"Bosnia and Herzegovina",389:"North Macedonia",420:"Czech Republic",421:"Slovakia",423:"Liechtenstein",500:"Falkland Islands",501:"Belize",502:"Guatemala",503:"El Salvador",504:"Honduras",505:"Nicaragua",506:"Costa Rica",507:"Panama",508:"Saint Pierre and Miquelon",509:"Haiti",590:"Guadeloupe",591:"Bolivia",592:"Guyana",593:"Ecuador",594:"French Guiana",595:"Paraguay",596:"Martinique",597:"Suriname",598:"Uruguay",599:"Caribbean Netherlands",670:"East Timor",672:"Antarctica",673:"Brunei",674:"Nauru",675:"Papua New Guinea",676:"Tonga",677:"Solomon Islands",678:"Vanuatu",679:"Fiji",680:"Palau",681:"Wallis and Futuna",682:"Cook Islands",683:"Niue",685:"Samoa",686:"Kiribati",687:"New Caledonia",688:"Tuvalu",689:"French Polynesia",690:"Tokelau",691:"Micronesia",692:"Marshall Islands",850:"North Korea",852:"Hong Kong",853:"Macau",855:"Cambodia",856:"Laos",880:"Bangladesh",886:"Taiwan",960:"Maldives",961:"Lebanon",962:"Jordan",963:"Syria",964:"Iraq",965:"Kuwait",966:"Saudi Arabia",967:"Yemen",968:"Oman",970:"Palestine",971:"UAE",972:"Israel",973:"Bahrain",974:"Qatar",975:"Bhutan",976:"Mongolia",977:"Nepal",992:"Tajikistan",993:"Turkmenistan",994:"Azerbaijan",995:"Georgia",996:"Kyrgyzstan",998:"Uzbekistan",int:"International",international:"International"};function Q(m,c){const l=m?String(m).replace(/\D/g,""):"";if(l.length>0){const i=l.slice(0,3),g=l.slice(0,2),j=l.slice(0,1);if(h[i])return h[i];if(h[g])return h[g];if(h[j])return h[j]}if(c!=null&&c!==""){const i=String(c).replace(/^\+/,"").trim().toLowerCase();return h[i]??h[c]??c}return"—"}function E(m,c){const l=m?String(m).replace(/\D/g,""):"";if(l.length>0){const i=l.slice(0,3),g=l.slice(0,2),j=l.slice(0,1);if(h[i])return i;if(h[g])return g;if(h[j])return j}return c??"—"}function C({title:m,value:c,sub:l,icon:i,className:g=""}){return e.jsx(b,{className:g,children:e.jsx(v,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:m}),e.jsx("p",{className:"text-2xl font-bold mt-0.5",children:c??"—"}),l!=null&&l!==""&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l})]}),i&&e.jsx(i,{className:"h-8 w-8 text-muted-foreground/60"})]})})})}function Ds(){const m=Le(),[c,l]=a.useState([]),[i,g]=a.useState({current_page:1,last_page:1,per_page:50,total:0}),[j,X]=a.useState(!1),[x,ee]=a.useState(null),[pe,se]=a.useState(!1),[_,ae]=a.useState({balance_int:null,balance_decimal:null,success:!1}),[te,re]=a.useState(!1),[ne,le]=a.useState(""),[ie,oe]=a.useState(!1),[ge,q]=a.useState(!1),[t,Y]=a.useState(null),[je,ce]=a.useState(!1),[O,$]=a.useState(1),[A,fe]=a.useState(50),[R,Ne]=a.useState(""),[z,ye]=a.useState("all"),[G,be]=a.useState(""),[U,ve]=a.useState(""),[D,_e]=a.useState("all"),[P,we]=a.useState("all"),[N,Se]=a.useState(!1),T=a.useCallback(async()=>{X(!0);try{const s={page:O,per_page:A};R?.trim()&&(s.phone_number=R.trim()),z==="true"&&(s.expired=!0),z==="false"&&(s.expired=!1),G&&(s.from_date=G),U&&(s.to_date=U),D&&D!=="all"&&(s.delivery_status=D),P&&P!=="all"&&(s.registration=P),N&&(s.group_by="phone");const d=await Be(s),u=N&&d.data?.otps_by_phone?d.data.otps_by_phone:d.data?.otps,Te=u?.data||[];l(Te),g({current_page:u?.current_page??1,last_page:u?.last_page??1,per_page:u?.per_page??A,total:u?.total??0})}catch(s){w.error(s.response?.data?.message||"Failed to load OTPs"),l([])}finally{X(!1)}},[O,A,R,z,G,U,D,P,N]);a.useEffect(()=>{T()},[T]);const K=a.useCallback(async()=>{se(!0);try{const s=await Ie();ee(s.data?.statistics??s.data??null)}catch{ee(null)}finally{se(!1)}},[]),W=a.useCallback(async()=>{re(!0);try{const s=await Fe();ae({success:s.data?.success??!1,balance_int:s.data?.balance_int??null,balance_decimal:s.data?.balance_decimal??null,error:s.data?.error??null})}catch(s){ae({success:!1,balance_int:null,balance_decimal:null,error:s.response?.data?.error||"Failed to fetch balance"})}finally{re(!1)}},[]);a.useEffect(()=>{K()},[K]),a.useEffect(()=>{W()},[W]);const Ce=async s=>{s.preventDefault();const d=ne?.trim();if(!d){w.error("Enter a batch ID");return}oe(!0);try{const u=(await Me(d)).data;u?.success?(w.success(`Updated ${u.otps_updated??0} OTP(s). Status: ${J[u.delivery_status]||u.delivery_status}`),le(""),T(),K()):w.error(u?.error||"Delivery report failed")}catch(y){w.error(y.response?.data?.error||y.response?.data?.message||"Failed to fetch delivery report")}finally{oe(!1)}},De=()=>{$(1),T()},de=s=>s?new Date(s)<new Date:!1,Pe=async s=>{q(!0),Y(null),ce(!0);try{const d=await Ee(s);Y(d.data?.otp??d.data??null)}catch{w.error("Failed to load OTP details"),Y(null)}finally{ce(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(Z,{className:"w-7 h-7"}),"OTP & SMS Analytics"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Audit trail of all OTPs. Delivery status is always live—every list, stats, or single-OTP request refreshes from Moursel first."})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7 gap-4",children:pe?e.jsx(b,{className:"col-span-full",children:e.jsx(v,{className:"py-8 flex justify-center",children:e.jsx(M,{className:"h-8 w-8 animate-spin text-muted-foreground"})})}):e.jsxs(e.Fragment,{children:[e.jsx(C,{title:"Total OTPs",value:x?.total_otps,icon:H}),e.jsx(C,{title:"Active",value:x?.active_otps,sub:"Not expired",icon:Z}),e.jsx(C,{title:"Expired",value:x?.expired_otps,icon:Z}),e.jsx(C,{title:"Today",value:x?.otps_today,icon:H}),e.jsx(C,{title:"This week",value:x?.otps_this_week,icon:H}),e.jsx(C,{title:"This month",value:x?.otps_this_month,icon:H}),e.jsx(b,{children:e.jsxs(v,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"SMS balance"}),te?e.jsx(M,{className:"h-6 w-6 animate-spin mt-1 text-muted-foreground"}):_.error?e.jsx("p",{className:"text-sm text-destructive mt-0.5",children:_.error}):e.jsx("p",{className:"text-xl font-bold mt-0.5",children:_.balance_decimal!=null?_.balance_decimal:_.balance_int??"—"})]}),e.jsx(Ve,{className:"h-8 w-8 text-muted-foreground/60"})]}),!te&&!_.error&&e.jsxs(p,{variant:"ghost",size:"sm",className:"mt-2 h-7 px-2",onClick:W,children:[e.jsx(ue,{className:"h-3 w-3 mr-1"})," Refresh"]})]})})]})}),x&&(x.phones_never_registered!=null||x.phones_became_user!=null)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(b,{className:"border-amber-200 bg-amber-50/50 dark:bg-amber-950/20 dark:border-amber-800",children:e.jsx(v,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ze,{className:"h-9 w-9 text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Phones never registered"}),e.jsx("p",{className:"text-2xl font-bold text-amber-800 dark:text-amber-200",children:x.phones_never_registered??"—"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Received OTP but not yet a user"})]})]})})}),e.jsx(b,{className:"border-emerald-200 bg-emerald-50/50 dark:bg-emerald-950/20 dark:border-emerald-800",children:e.jsx(v,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(He,{className:"h-9 w-9 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Phones became user"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-800 dark:text-emerald-200",children:x.phones_became_user??"—"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"OTP led to signup"})]})]})})})]}),e.jsxs(b,{className:"bg-muted/30",children:[e.jsxs(me,{children:[e.jsxs(xe,{className:"text-sm flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"Delivery status"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Every OTP list, statistics, and single-OTP request refreshes delivery from Moursel first—data is always live. Optionally fetch a single batch below (e.g. for debugging)."})]}),e.jsx(v,{children:e.jsxs("form",{onSubmit:Ce,className:"flex flex-wrap items-end gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"Batch ID (on-demand)"}),e.jsx(V,{placeholder:"e.g. abc-123",value:ne,onChange:s=>le(s.target.value),className:"w-48"})]}),e.jsxs(p,{type:"submit",disabled:ie,children:[ie?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx(he,{className:"w-4 h-4 mr-1"}),"Fetch this batch"]})]})})]}),e.jsxs(b,{children:[e.jsxs(me,{children:[e.jsx(xe,{className:"text-base",children:"OTP list"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Filter and group for analysis. Delivery status is refreshed from Moursel on every load."})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"Phone"}),e.jsx(V,{placeholder:"Filter by phone",value:R,onChange:s=>Ne(s.target.value),className:"w-36"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"Expired"}),e.jsxs(L,{value:z,onValueChange:ye,children:[e.jsx(B,{className:"w-28",children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"all",children:"All"}),e.jsx(o,{value:"true",children:"Expired only"}),e.jsx(o,{value:"false",children:"Active only"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"From"}),e.jsx(V,{type:"date",value:G,onChange:s=>be(s.target.value),className:"w-32"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"To"}),e.jsx(V,{type:"date",value:U,onChange:s=>ve(s.target.value),className:"w-32"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"Delivery"}),e.jsxs(L,{value:D,onValueChange:_e,children:[e.jsx(B,{className:"w-32",children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"all",children:"All"}),e.jsx(o,{value:"20",children:"Delivered"}),e.jsx(o,{value:"21",children:"Not delivered"}),e.jsx(o,{value:"22",children:"Waiting"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"Registration"}),e.jsxs(L,{value:P,onValueChange:we,children:[e.jsx(B,{className:"w-40",children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"all",children:"All"}),e.jsx(o,{value:"only_not_registered",children:"Not registered"}),e.jsx(o,{value:"only_became_user",children:"Became user"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"View"}),e.jsxs(L,{value:N?"phone":"list",onValueChange:s=>Se(s==="phone"),children:[e.jsx(B,{className:"w-28",children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"list",children:"Per OTP"}),e.jsx(o,{value:"phone",children:"By phone"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"text-xs",children:"Per page"}),e.jsxs(L,{value:String(A),onValueChange:s=>fe(Number(s)),children:[e.jsx(B,{className:"w-20",children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"20",children:"20"}),e.jsx(o,{value:"50",children:"50"}),e.jsx(o,{value:"100",children:"100"})]})]})]}),e.jsx(p,{variant:"outline",onClick:De,children:"Apply"}),e.jsx(p,{variant:"outline",size:"icon",onClick:()=>{T(),K()},disabled:j,children:e.jsx(ue,{className:`w-4 h-4 ${j?"animate-spin":""}`})})]}),e.jsx("div",{className:"rounded-xl border bg-card overflow-hidden shadow-sm",children:e.jsx("div",{className:"overflow-auto max-h-[min(70vh,800px)]",children:e.jsxs(Oe,{children:[e.jsx(Ae,{children:e.jsx(k,{className:"border-b bg-muted/80 hover:bg-muted/80 sticky top-0 z-10 shadow-[0_1px_0_0_hsl(var(--border))] [&_th]:bg-muted/80",children:N?e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"Phone"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"Last sent"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"OTP count"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"Country"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"Registered"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"User ID"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5 w-14",children:"ID"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5 min-w-[120px]",children:"Phone"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5 w-20",children:"Code"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"Created"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"Batch ID"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5 min-w-[100px]",children:"Country"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"Delivery"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5",children:"Report at"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5 w-20",children:"Status"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5 w-16 text-center",children:"#"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5 w-24",children:"Registered"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5 w-16",children:"User"}),e.jsx(n,{className:"font-semibold text-foreground whitespace-nowrap py-3.5 w-12"})]})})}),e.jsx(Re,{children:j?e.jsx(k,{className:"hover:bg-transparent",children:e.jsxs(r,{colSpan:N?6:13,className:"text-center py-16",children:[e.jsx(M,{className:"h-8 w-8 animate-spin mx-auto text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Loading OTPs…"})]})}):c.length===0?e.jsx(k,{className:"hover:bg-transparent",children:e.jsx(r,{colSpan:N?6:13,className:"text-center py-16 text-muted-foreground",children:"No OTPs match your filters."})}):N?c.map((s,d)=>e.jsxs(k,{className:`transition-colors ${d%2===1?"bg-muted/20":""} hover:bg-muted/40`,children:[e.jsx(r,{className:"font-mono text-sm py-2.5",children:s.phone_number}),e.jsx(r,{className:"text-sm text-muted-foreground py-2.5",children:s.last_sent_at?new Date(s.last_sent_at).toLocaleString():"—"}),e.jsx(r,{className:"text-sm font-medium py-2.5",children:s.otp_count??"—"}),e.jsxs(r,{className:"text-sm py-2.5",children:[e.jsx("span",{className:"font-medium text-foreground",children:Q(s.phone_number,s.country_origin)}),E(s.phone_number,s.country_origin)!=="—"&&e.jsxs("span",{className:"text-muted-foreground text-xs ml-1",children:["(+",E(s.phone_number,s.country_origin),")"]})]}),e.jsx(r,{className:"py-2.5",children:s.is_registered_user!=null?s.is_registered_user?e.jsx(S,{variant:"default",className:"bg-emerald-600 hover:bg-emerald-600 text-xs font-medium",children:"Yes"}):e.jsx(S,{variant:"destructive",className:"bg-red-600 hover:bg-red-600 text-xs font-medium",children:"No"}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(r,{className:"py-2.5",children:s.registered_user_id!=null?e.jsx(p,{variant:"link",className:"h-auto p-0 font-mono text-sm text-primary hover:underline",onClick:()=>m("/admin/users"),children:s.registered_user_id}):e.jsx("span",{className:"text-muted-foreground",children:"—"})})]},s.phone_number)):c.map((s,d)=>{const y=s.is_expired??de(s.expired_at);return e.jsxs(k,{className:`transition-colors ${d%2===1?"bg-muted/20":""} hover:bg-muted/40`,children:[e.jsx(r,{className:"font-mono text-sm py-2.5 text-muted-foreground",children:s.id}),e.jsx(r,{className:"font-mono text-sm py-2.5",children:s.phone_number}),e.jsx(r,{className:"font-mono font-semibold text-sm py-2.5",children:s.code}),e.jsx(r,{className:"text-sm text-muted-foreground py-2.5 whitespace-nowrap",children:s.created_at?new Date(s.created_at).toLocaleString():"—"}),e.jsx(r,{className:"font-mono text-xs text-muted-foreground py-2.5 max-w-[100px] truncate",title:s.batch_id??"",children:s.batch_id??"—"}),e.jsxs(r,{className:"py-2.5",children:[e.jsx("span",{className:"font-medium text-foreground text-sm",children:Q(s.phone_number,s.country_origin)}),E(s.phone_number,s.country_origin)!=="—"&&e.jsxs("span",{className:"text-muted-foreground text-xs ml-1",children:["(+",E(s.phone_number,s.country_origin),")"]})]}),e.jsx(r,{className:"py-2.5",children:s.delivery_status!=null?e.jsx(S,{variant:"outline",className:"text-xs font-medium",children:J[s.delivery_status]??s.delivery_status}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(r,{className:"text-sm text-muted-foreground py-2.5 whitespace-nowrap",children:s.delivery_report_at?new Date(s.delivery_report_at).toLocaleString():"—"}),e.jsx(r,{className:"py-2.5",children:e.jsx(S,{variant:y?"destructive":"default",className:"text-xs font-medium",children:y?"Expired":"Active"})}),e.jsx(r,{className:"text-sm font-medium py-2.5 text-center",children:s.otp_count_for_this_number??"—"}),e.jsx(r,{className:"py-2.5",children:s.is_registered_user!=null?s.is_registered_user?e.jsx(S,{variant:"default",className:"bg-emerald-600 hover:bg-emerald-600 text-xs font-medium",children:"Yes"}):e.jsx(S,{variant:"destructive",className:"bg-red-600 hover:bg-red-600 text-xs font-medium",children:"No"}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(r,{className:"py-2.5",children:s.registered_user_id!=null?e.jsx(p,{variant:"link",className:"h-auto p-0 font-mono text-sm text-primary hover:underline",onClick:()=>m("/admin/users"),children:s.registered_user_id}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(r,{className:"py-2",children:e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>Pe(s.id),className:"h-8 w-8 rounded-md hover:bg-muted",title:"View details",children:e.jsx(qe,{className:"h-4 w-4"})})})]},s.id)})})]})})}),i.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Page ",i.current_page," of ",i.last_page," · Total ",i.total]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"outline",size:"sm",disabled:O<=1,onClick:()=>$(s=>s-1),children:e.jsx(Ye,{className:"w-4 h-4"})}),e.jsx(p,{variant:"outline",size:"sm",disabled:O>=i.last_page,onClick:()=>$(s=>s+1),children:e.jsx($e,{className:"w-4 h-4"})})]})]})]})]}),e.jsx(ze,{open:ge,onOpenChange:q,children:e.jsxs(Ge,{className:"max-w-md",children:[e.jsx(Ue,{children:e.jsx(Ke,{children:"OTP details"})}),je?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(M,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):t?e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"ID:"})," ",e.jsx("span",{className:"font-mono",children:t.id})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Phone:"})," ",e.jsx("span",{className:"font-mono",children:t.phone_number})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Code:"})," ",e.jsx("span",{className:"font-mono font-semibold",children:t.code})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Batch ID:"})," ",e.jsx("span",{className:"font-mono",children:t.batch_id??"—"})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Country:"})," ",Q(t.phone_number,t.country_origin),(()=>{const s=E(t.phone_number,t.country_origin);return s!=="—"?` (+${s})`:""})()]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Delivery:"})," ",t.delivery_status!=null?J[t.delivery_status]??t.delivery_status:"—"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Delivery report at:"})," ",t.delivery_report_at?new Date(t.delivery_report_at).toLocaleString():"—"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"})," ",t.created_at?new Date(t.created_at).toLocaleString():"—"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Expired at:"})," ",t.expired_at?new Date(t.expired_at).toLocaleString():"—"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Is expired:"})," ",t.is_expired??de(t.expired_at)?"Yes":"No"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Registered user:"})," ",t.is_registered_user!=null?t.is_registered_user?"Yes":"No":"—"]}),t.registered_user_id!=null&&e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"User ID:"})," ",e.jsx(p,{variant:"link",className:"h-auto p-0 font-mono",onClick:()=>{q(!1),m("/admin/users")},children:t.registered_user_id})]})]}):e.jsx("p",{className:"text-muted-foreground",children:"No details"})]})})]})}export{Ds as default};
